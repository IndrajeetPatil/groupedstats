<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Grouped Statistical Analyses in a Tidy Way • groupedstats</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/all.min.css" integrity="sha256-PbSmjxuVAzJ6FPvNYsrXygfGhNJYyZ2GktDbkMBqQZg=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/v4-shims.min.css" integrity="sha256-A6jcAdwFD48VMjlI3GDxUd+eCQa7/KWy6G9oe/ovaPA=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><!-- docsearch --><script src="docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><link href="extra.css" rel="stylesheet">
<meta property="og:title" content="Grouped Statistical Analyses in a Tidy Way">
<meta property="og:description" content="Collection of functions to run statistical tests
    across all combinations of multiple grouping variables.">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">groupedstats</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.1.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/IndrajeetPatil/groupedstats">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<div id="groupedstats-grouped-statistical-analysis-in-a-tidy-way" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#groupedstats-grouped-statistical-analysis-in-a-tidy-way" class="anchor"></a>groupedstats: Grouped statistical analysis in a tidy way</h1></div>

</div>
<div id="overview" class="section level1">
<h1 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h1>
<p><code>groupedstats</code> package provides a collection of functions to run statistical operations on multiple variables across multiple grouping variables in a dataframe. This is a common situation, as illustrated by few example cases-</p>
<ol>
<li>If you have combined multiple studies in a single dataframe and want to run a common operation (e.g., linear regression) on <strong>each study</strong>. In this case, column corresponding to <code>study</code> will be the grouping variable.</li>
<li>If you have multiple groups in your dataframe (e.g., clinical disorder groups and controls group) and you want to carry out the same operation for <strong>each group</strong> (e.g., planned t-test to check for differences in reaction time in condition 1 versus condition 2 for both groups). In this case, <code>group</code> will be the grouping variable.</li>
<li>If you have multiple conditions in a given study (e.g., six types of videos participants saw) and want to run a common operation between different measures of interest for <strong>each condition</strong> (e.g., correlation between subjective rating of emotional intensity and reaction time).</li>
<li>Combination of all of the above.</li>
</ol>
</div>
<div id="retirement" class="section level1">
<h1 class="hasAnchor">
<a href="#retirement" class="anchor"></a>Retirement</h1>
<p>This package is no longer under active development and no new functionality will be added. The package will continue to be available on <code>CRAN</code> and all releases will primarily be focused on maintenance and bug fixes. This is for two reasons-</p>
<ol>
<li><p>There are more general versions of these functions introduced in <code>broomExtra</code> package:<br><code>grouped_tidy</code>, <code>grouped_augment</code>, <code>grouped_glance</code>. For more, see: <a href="https://indrajeetpatil.github.io/broomExtra/reference/index.html#section-grouped-variants-of-generics" class="uri">https://indrajeetpatil.github.io/broomExtra/reference/index.html#section-grouped-variants-of-generics</a></p></li>
<li><p><code>dplyr 0.8.1</code> introduced <code>group_map()</code>, <code>group_modify()</code> and <code>group_walk()</code> functions that can be used to iterate on grouped dataframes. So if you want to do <code>grouped_</code> operations, I would highly recommend using these functions over <code>groupedstats</code> functions since the former are much more general, efficient, and faster than the latter.</p></li>
</ol>
<p>For more, see: <a href="https://dplyr.tidyverse.org/reference/group_map.html" class="uri">https://dplyr.tidyverse.org/reference/group_map.html</a></p>
</div>
<div id="installation" class="section level1">
<h1 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h1>
<p>To get the latest, stable <code>CRAN</code> release (0.1.1):</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>utils<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="dt">pkgs =</span> <span class="st">"groupedstats"</span>)</span></code></pre></div>
<p>You can get the <strong>development</strong> version of the package from <code>GitHub</code> (<code>0.1.1.9000</code>). To see what new changes (and bug fixes) have been made to the package since the last release on <code>CRAN</code>, you can check the detailed log of changes here: <a href="https://indrajeetpatil.github.io/groupedstats/news/index.html" class="uri">https://indrajeetpatil.github.io/groupedstats/news/index.html</a></p>
<p>If you are in hurry and want to reduce the time of installation, prefer-</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># needed package to download from GitHub repo</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>utils<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="dt">pkgs =</span> <span class="st">"remotes"</span>)</span>
<span id="cb2-3"><a href="#cb2-3"></a></span>
<span id="cb2-4"><a href="#cb2-4"></a>remotes<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/remotes/man/install_github.html">install_github</a></span>(</span>
<span id="cb2-5"><a href="#cb2-5"></a>  <span class="dt">repo =</span> <span class="st">"IndrajeetPatil/groupedstats"</span>, <span class="co"># package path on GitHub</span></span>
<span id="cb2-6"><a href="#cb2-6"></a>  <span class="dt">quick =</span> <span class="ot">TRUE</span></span>
<span id="cb2-7"><a href="#cb2-7"></a>) <span class="co"># skips docs, demos, and vignettes</span></span></code></pre></div>
<p>If time is not a constraint-</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>remotes<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/remotes/man/install_github.html">install_github</a></span>(</span>
<span id="cb3-2"><a href="#cb3-2"></a>  <span class="dt">repo =</span> <span class="st">"IndrajeetPatil/groupedstats"</span>, <span class="co"># package path on GitHub</span></span>
<span id="cb3-3"><a href="#cb3-3"></a>  <span class="dt">dependencies =</span> <span class="ot">TRUE</span>, <span class="co"># installs packages which groupedstats depends on</span></span>
<span id="cb3-4"><a href="#cb3-4"></a>  <span class="dt">upgrade_dependencies =</span> <span class="ot">TRUE</span> <span class="co"># updates any out of date dependencies</span></span>
<span id="cb3-5"><a href="#cb3-5"></a>)</span></code></pre></div>
</div>
<div id="citation" class="section level1">
<h1 class="hasAnchor">
<a href="#citation" class="anchor"></a>Citation</h1>
<p>If you want to cite this package in a scientific journal or in any other context, run the following code in your <code>R</code> console:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>utils<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/utils/citation.html">citation</a></span>(<span class="dt">package =</span> <span class="st">"groupedstats"</span>)</span></code></pre></div>
</div>
<div id="help" class="section level1">
<h1 class="hasAnchor">
<a href="#help" class="anchor"></a>Help</h1>
<p>There is a dedicated website to <code>groupedstats</code>, which is updated after every new commit: <a href="https://indrajeetpatil.github.io/groupedstats/" class="uri">https://indrajeetpatil.github.io/groupedstats/</a>.</p>
<p>To see arguments for any of the functions, use <code>args</code>. For example-</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw"><a href="https://rdrr.io/r/base/args.html">args</a></span>(groupedstats<span class="op">::</span>grouped_ttest)</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="co">#&gt; Registered S3 method overwritten by 'broom.mixed':</span></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co">#&gt;   method      from </span></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="co">#&gt;   tidy.gamlss broom</span></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="co">#&gt; function (data, dep.vars, indep.vars, grouping.vars, paired = FALSE, </span></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="co">#&gt;     var.equal = FALSE) </span></span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="co">#&gt; NULL</span></span></code></pre></div>
<p>In case you want to look at the function body for any of the functions, just type the name of the function without the parentheses:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>groupedstats<span class="op">::</span>grouped_summary</span></code></pre></div>
<p>If you are not familiar either with what the namespace <code>::</code> does or how to use pipe operator <code><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></code>, something this package and its documentation relies a lot on, you can check out these links-</p>
<ul>
<li><a href="http://r-pkgs.had.co.nz/namespace.html" class="uri">http://r-pkgs.had.co.nz/namespace.html</a></li>
<li><a href="http://r4ds.had.co.nz/pipes.html" class="uri">http://r4ds.had.co.nz/pipes.html</a></li>
</ul>
</div>
<div id="usage" class="section level1">
<h1 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h1>
<p>Below is a short introduction to the currently available functions in this package:</p>
<div id="grouped_-versions-of-broom-generic-functions" class="section level2">
<h2 class="hasAnchor">
<a href="#grouped_-versions-of-broom-generic-functions" class="anchor"></a><code>grouped_</code> versions of <code>broom</code> generic functions</h2>
<p>These functions are re-exported from <code>broomExtra</code> package and provide the most general versions of <code>grouped_</code> functions.</p>
<p>Here is an example</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># for reproducibility</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb7-3"><a href="#cb7-3"></a></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="co"># running glm across two all combinations of two grouping variables</span></span>
<span id="cb7-5"><a href="#cb7-5"></a>groupedstats<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/groupedstats//reference/reexports.html">grouped_tidy</a></span>(</span>
<span id="cb7-6"><a href="#cb7-6"></a>  <span class="dt">data =</span> groupedstats<span class="op">::</span>Titanic_full, <span class="co"># dataframe</span></span>
<span id="cb7-7"><a href="#cb7-7"></a>  <span class="dt">grouping.vars =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(Class, Age), <span class="co"># grouping variables</span></span>
<span id="cb7-8"><a href="#cb7-8"></a>  <span class="dt">..f =</span> stats<span class="op">::</span>glm, <span class="co"># function to execute</span></span>
<span id="cb7-9"><a href="#cb7-9"></a>  <span class="co"># additional arguments passed to `..f`</span></span>
<span id="cb7-10"><a href="#cb7-10"></a>  <span class="dt">formula =</span> Survived <span class="op">~</span><span class="st"> </span>Sex,</span>
<span id="cb7-11"><a href="#cb7-11"></a>  <span class="dt">family =</span> stats<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span>(<span class="dt">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb7-12"><a href="#cb7-12"></a>)</span>
<span id="cb7-13"><a href="#cb7-13"></a><span class="co">#&gt; # A tibble: 14 x 7</span></span>
<span id="cb7-14"><a href="#cb7-14"></a><span class="co">#&gt;    Class Age   term         estimate  std.error statistic  p.value</span></span>
<span id="cb7-15"><a href="#cb7-15"></a><span class="co">#&gt;    &lt;fct&gt; &lt;fct&gt; &lt;chr&gt;           &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span id="cb7-16"><a href="#cb7-16"></a><span class="co">#&gt;  1 1st   Adult (Intercept)  3.56e+ 0      0.507  7.01e+ 0 2.36e-12</span></span>
<span id="cb7-17"><a href="#cb7-17"></a><span class="co">#&gt;  2 1st   Adult SexMale     -4.28e+ 0      0.532 -8.05e+ 0 8.36e-16</span></span>
<span id="cb7-18"><a href="#cb7-18"></a><span class="co">#&gt;  3 1st   Child (Intercept) -2.46e+ 1 131011.    -1.88e- 4 1.00e+ 0</span></span>
<span id="cb7-19"><a href="#cb7-19"></a><span class="co">#&gt;  4 1st   Child SexMale     -1.74e-15 143515.    -1.21e-20 1.00e+ 0</span></span>
<span id="cb7-20"><a href="#cb7-20"></a><span class="co">#&gt;  5 2nd   Adult (Intercept)  1.82e+ 0      0.299  6.08e+ 0 1.23e- 9</span></span>
<span id="cb7-21"><a href="#cb7-21"></a><span class="co">#&gt;  6 2nd   Adult SexMale     -4.21e+ 0      0.409 -1.03e+ 1 6.79e-25</span></span>
<span id="cb7-22"><a href="#cb7-22"></a><span class="co">#&gt;  7 2nd   Child (Intercept) -2.56e+ 1  59908.    -4.27e- 4 1.00e+ 0</span></span>
<span id="cb7-23"><a href="#cb7-23"></a><span class="co">#&gt;  8 2nd   Child SexMale     -7.14e-15  88489.    -8.07e-20 1.00e+ 0</span></span>
<span id="cb7-24"><a href="#cb7-24"></a><span class="co">#&gt;  9 3rd   Adult (Intercept) -1.58e- 1      0.156 -1.01e+ 0 3.12e- 1</span></span>
<span id="cb7-25"><a href="#cb7-25"></a><span class="co">#&gt; 10 3rd   Adult SexMale     -1.48e+ 0      0.201 -7.39e+ 0 1.51e-13</span></span>
<span id="cb7-26"><a href="#cb7-26"></a><span class="co">#&gt; 11 3rd   Child (Intercept) -1.94e- 1      0.361 -5.38e- 1 5.91e- 1</span></span>
<span id="cb7-27"><a href="#cb7-27"></a><span class="co">#&gt; 12 3rd   Child SexMale     -7.96e- 1      0.486 -1.64e+ 0 1.01e- 1</span></span>
<span id="cb7-28"><a href="#cb7-28"></a><span class="co">#&gt; 13 Crew  Adult (Intercept)  1.90e+ 0      0.619  3.06e+ 0 2.18e- 3</span></span>
<span id="cb7-29"><a href="#cb7-29"></a><span class="co">#&gt; 14 Crew  Adult SexMale     -3.15e+ 0      0.625 -5.04e+ 0 4.68e- 7</span></span></code></pre></div>
<p>For more examples, see: <a href="https://indrajeetpatil.github.io/broomExtra/reference/index.html#section-grouped-variants-of-generics" class="uri">https://indrajeetpatil.github.io/broomExtra/reference/index.html#section-grouped-variants-of-generics</a></p>
</div>
<div id="grouped_summary" class="section level2">
<h2 class="hasAnchor">
<a href="#grouped_summary" class="anchor"></a><code>grouped_summary</code>
</h2>
<p>Getting summary for multiple variables across multiple grouping variables. This function is a wrapper around <code><a href="https://docs.ropensci.org/skimr/reference/deprecated-v1.html">skimr::skim_to_wide()</a></code>. It is supposed to be a handy summarizing tool if you have multiple grouping variables and multiple variables for which summary statistics are to be computed-</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># for reproducibility</span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(datasets)</span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="kw"><a href="https://rdrr.io/r/base/options.html">options</a></span>(<span class="dt">tibble.width =</span> <span class="ot">Inf</span>) <span class="co"># show me all columns</span></span>
<span id="cb8-5"><a href="#cb8-5"></a></span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="co"># note that this dataset has NAs</span></span>
<span id="cb8-7"><a href="#cb8-7"></a>groupedstats<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/groupedstats//reference/grouped_summary.html">grouped_summary</a></span>(</span>
<span id="cb8-8"><a href="#cb8-8"></a>  <span class="dt">data =</span> ggplot2<span class="op">::</span>msleep,</span>
<span id="cb8-9"><a href="#cb8-9"></a>  <span class="dt">grouping.vars =</span> vore,</span>
<span id="cb8-10"><a href="#cb8-10"></a>  <span class="dt">measures =</span> sleep_total<span class="op">:</span>awake,</span>
<span id="cb8-11"><a href="#cb8-11"></a>  <span class="dt">measures.type =</span> <span class="st">"numeric"</span></span>
<span id="cb8-12"><a href="#cb8-12"></a>)</span>
<span id="cb8-13"><a href="#cb8-13"></a><span class="co">#&gt; # A tibble: 16 x 16</span></span>
<span id="cb8-14"><a href="#cb8-14"></a><span class="co">#&gt;    vore    skim_type variable    missing complete   mean     sd   min    p25</span></span>
<span id="cb8-15"><a href="#cb8-15"></a><span class="co">#&gt;    &lt;fct&gt;   &lt;chr&gt;     &lt;chr&gt;         &lt;int&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span id="cb8-16"><a href="#cb8-16"></a><span class="co">#&gt;  1 carni   numeric   sleep_total       0    1     10.4   4.67   2.7    6.25 </span></span>
<span id="cb8-17"><a href="#cb8-17"></a><span class="co">#&gt;  2 carni   numeric   sleep_rem         9    0.526  2.29  1.86   0.1    1.33 </span></span>
<span id="cb8-18"><a href="#cb8-18"></a><span class="co">#&gt;  3 carni   numeric   sleep_cycle      14    0.263  0.373 0.0325 0.333  0.35 </span></span>
<span id="cb8-19"><a href="#cb8-19"></a><span class="co">#&gt;  4 carni   numeric   awake             0    1     13.6   4.68   4.6   11    </span></span>
<span id="cb8-20"><a href="#cb8-20"></a><span class="co">#&gt;  5 herbi   numeric   sleep_total       0    1      9.51  4.88   1.9    4.3  </span></span>
<span id="cb8-21"><a href="#cb8-21"></a><span class="co">#&gt;  6 herbi   numeric   sleep_rem         8    0.75   1.37  0.922  0.4    0.6  </span></span>
<span id="cb8-22"><a href="#cb8-22"></a><span class="co">#&gt;  7 herbi   numeric   sleep_cycle      20    0.375  0.418 0.324  0.117  0.183</span></span>
<span id="cb8-23"><a href="#cb8-23"></a><span class="co">#&gt;  8 herbi   numeric   awake             0    1     14.5   4.88   7.4    9.78 </span></span>
<span id="cb8-24"><a href="#cb8-24"></a><span class="co">#&gt;  9 insecti numeric   sleep_total       0    1     14.9   5.92   8.4    8.6  </span></span>
<span id="cb8-25"><a href="#cb8-25"></a><span class="co">#&gt; 10 insecti numeric   sleep_rem         1    0.8    3.52  1.93   2      2.08 </span></span>
<span id="cb8-26"><a href="#cb8-26"></a><span class="co">#&gt; 11 insecti numeric   sleep_cycle       2    0.6    0.161 0.0419 0.117  0.142</span></span>
<span id="cb8-27"><a href="#cb8-27"></a><span class="co">#&gt; 12 insecti numeric   awake             0    1      9.06  5.92   4.1    4.3  </span></span>
<span id="cb8-28"><a href="#cb8-28"></a><span class="co">#&gt; 13 omni    numeric   sleep_total       0    1     10.9   2.95   8      9.1  </span></span>
<span id="cb8-29"><a href="#cb8-29"></a><span class="co">#&gt; 14 omni    numeric   sleep_rem         2    0.9    1.96  1.01   0.7    1.25 </span></span>
<span id="cb8-30"><a href="#cb8-30"></a><span class="co">#&gt; 15 omni    numeric   sleep_cycle       9    0.55   0.592 0.473  0.133  0.258</span></span>
<span id="cb8-31"><a href="#cb8-31"></a><span class="co">#&gt; 16 omni    numeric   awake             0    1     13.1   2.95   6     13.1  </span></span>
<span id="cb8-32"><a href="#cb8-32"></a><span class="co">#&gt;    median    p75    max     n std.error mean.conf.low mean.conf.high</span></span>
<span id="cb8-33"><a href="#cb8-33"></a><span class="co">#&gt;     &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;     &lt;dbl&gt;         &lt;dbl&gt;          &lt;dbl&gt;</span></span>
<span id="cb8-34"><a href="#cb8-34"></a><span class="co">#&gt;  1 10.4   13     19.4      19    1.07          8.13           12.6  </span></span>
<span id="cb8-35"><a href="#cb8-35"></a><span class="co">#&gt;  2  1.95   3.05   6.6      10    0.589         0.958           3.62 </span></span>
<span id="cb8-36"><a href="#cb8-36"></a><span class="co">#&gt;  3  0.383  0.383  0.417     5    0.0145        0.333           0.414</span></span>
<span id="cb8-37"><a href="#cb8-37"></a><span class="co">#&gt;  4 13.6   17.8   21.4      19    1.07         11.4            15.9  </span></span>
<span id="cb8-38"><a href="#cb8-38"></a><span class="co">#&gt;  5 10.3   14.2   16.6      32    0.862         7.75           11.3  </span></span>
<span id="cb8-39"><a href="#cb8-39"></a><span class="co">#&gt;  6  0.95   1.98   3.4      24    0.188         0.977           1.76 </span></span>
<span id="cb8-40"><a href="#cb8-40"></a><span class="co">#&gt;  7  0.217  0.692  1        12    0.0936        0.212           0.624</span></span>
<span id="cb8-41"><a href="#cb8-41"></a><span class="co">#&gt;  8 13.7   19.7   22.1      32    0.862        12.7            16.2  </span></span>
<span id="cb8-42"><a href="#cb8-42"></a><span class="co">#&gt;  9 18.1   19.7   19.9       5    2.65          7.59           22.3  </span></span>
<span id="cb8-43"><a href="#cb8-43"></a><span class="co">#&gt; 10  3      4.45   6.1       4    0.963         0.460           6.59 </span></span>
<span id="cb8-44"><a href="#cb8-44"></a><span class="co">#&gt; 11  0.167  0.183  0.2       3    0.0242        0.0569          0.265</span></span>
<span id="cb8-45"><a href="#cb8-45"></a><span class="co">#&gt; 12  5.9   15.4   15.6       5    2.65          1.71           16.4  </span></span>
<span id="cb8-46"><a href="#cb8-46"></a><span class="co">#&gt; 13  9.9   10.9   18        20    0.659         9.54           12.3  </span></span>
<span id="cb8-47"><a href="#cb8-47"></a><span class="co">#&gt; 14  1.85   2.3    4.9      18    0.239         1.45            2.46 </span></span>
<span id="cb8-48"><a href="#cb8-48"></a><span class="co">#&gt; 15  0.5    0.708  1.5      11    0.143         0.274           0.911</span></span>
<span id="cb8-49"><a href="#cb8-49"></a><span class="co">#&gt; 16 14.1   14.9   16        20    0.659        11.7            14.5</span></span></code></pre></div>
<p>This function can be used to get summary of either numeric <strong>or</strong> factor variables, but <strong>not</strong> both. This is by design. If no <code>measures</code> are specified, the function will compute summary for all variables of the specified type (<code>numeric</code> or <code>factor</code>).</p>
<p>If you want summary of variables of <code>factor</code> type-</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co"># for reproducibility</span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ggplot2)</span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="kw"><a href="https://rdrr.io/r/base/options.html">options</a></span>(<span class="dt">tibble.width =</span> <span class="ot">Inf</span>) <span class="co"># show me all columns</span></span>
<span id="cb9-5"><a href="#cb9-5"></a></span>
<span id="cb9-6"><a href="#cb9-6"></a>groupedstats<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/groupedstats//reference/grouped_summary.html">grouped_summary</a></span>(</span>
<span id="cb9-7"><a href="#cb9-7"></a>  <span class="dt">data =</span> ggplot2<span class="op">::</span>diamonds,</span>
<span id="cb9-8"><a href="#cb9-8"></a>  <span class="dt">grouping.vars =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(cut, clarity),</span>
<span id="cb9-9"><a href="#cb9-9"></a>  <span class="dt">measures =</span> color,</span>
<span id="cb9-10"><a href="#cb9-10"></a>  <span class="dt">measures.type =</span> <span class="st">"factor"</span></span>
<span id="cb9-11"><a href="#cb9-11"></a>)</span>
<span id="cb9-12"><a href="#cb9-12"></a><span class="co">#&gt; # A tibble: 40 x 10</span></span>
<span id="cb9-13"><a href="#cb9-13"></a><span class="co">#&gt;    cut   clarity skim_type variable missing complete ordered n_unique</span></span>
<span id="cb9-14"><a href="#cb9-14"></a><span class="co">#&gt;    &lt;ord&gt; &lt;ord&gt;   &lt;chr&gt;     &lt;chr&gt;      &lt;int&gt;    &lt;dbl&gt; &lt;lgl&gt;      &lt;int&gt;</span></span>
<span id="cb9-15"><a href="#cb9-15"></a><span class="co">#&gt;  1 Fair  I1      factor    color          0        1 TRUE           7</span></span>
<span id="cb9-16"><a href="#cb9-16"></a><span class="co">#&gt;  2 Fair  SI2     factor    color          0        1 TRUE           7</span></span>
<span id="cb9-17"><a href="#cb9-17"></a><span class="co">#&gt;  3 Fair  SI1     factor    color          0        1 TRUE           7</span></span>
<span id="cb9-18"><a href="#cb9-18"></a><span class="co">#&gt;  4 Fair  VS2     factor    color          0        1 TRUE           7</span></span>
<span id="cb9-19"><a href="#cb9-19"></a><span class="co">#&gt;  5 Fair  VS1     factor    color          0        1 TRUE           7</span></span>
<span id="cb9-20"><a href="#cb9-20"></a><span class="co">#&gt;  6 Fair  VVS2    factor    color          0        1 TRUE           7</span></span>
<span id="cb9-21"><a href="#cb9-21"></a><span class="co">#&gt;  7 Fair  VVS1    factor    color          0        1 TRUE           7</span></span>
<span id="cb9-22"><a href="#cb9-22"></a><span class="co">#&gt;  8 Fair  IF      factor    color          0        1 TRUE           3</span></span>
<span id="cb9-23"><a href="#cb9-23"></a><span class="co">#&gt;  9 Good  I1      factor    color          0        1 TRUE           7</span></span>
<span id="cb9-24"><a href="#cb9-24"></a><span class="co">#&gt; 10 Good  SI2     factor    color          0        1 TRUE           7</span></span>
<span id="cb9-25"><a href="#cb9-25"></a><span class="co">#&gt;    top_counts                         n</span></span>
<span id="cb9-26"><a href="#cb9-26"></a><span class="co">#&gt;    &lt;chr&gt;                          &lt;int&gt;</span></span>
<span id="cb9-27"><a href="#cb9-27"></a><span class="co">#&gt;  1 G: 53, H: 52, F: 35, I: 34       210</span></span>
<span id="cb9-28"><a href="#cb9-28"></a><span class="co">#&gt;  2 H: 91, F: 89, G: 80, E: 78       466</span></span>
<span id="cb9-29"><a href="#cb9-29"></a><span class="co">#&gt;  3 F: 83, H: 75, G: 69, E: 65       408</span></span>
<span id="cb9-30"><a href="#cb9-30"></a><span class="co">#&gt;  4 F: 53, G: 45, E: 42, H: 41       261</span></span>
<span id="cb9-31"><a href="#cb9-31"></a><span class="co">#&gt;  5 G: 45, F: 33, H: 32, I: 25       170</span></span>
<span id="cb9-32"><a href="#cb9-32"></a><span class="co">#&gt;  6 G: 17, E: 13, H: 11, F: 10        69</span></span>
<span id="cb9-33"><a href="#cb9-33"></a><span class="co">#&gt;  7 F: 5, D: 3, E: 3, G: 3            17</span></span>
<span id="cb9-34"><a href="#cb9-34"></a><span class="co">#&gt;  8 F: 4, D: 3, G: 2, E: 0             9</span></span>
<span id="cb9-35"><a href="#cb9-35"></a><span class="co">#&gt;  9 E: 23, F: 19, G: 19, H: 14        96</span></span>
<span id="cb9-36"><a href="#cb9-36"></a><span class="co">#&gt; 10 D: 223, E: 202, F: 201, G: 163  1081</span></span>
<span id="cb9-37"><a href="#cb9-37"></a><span class="co">#&gt; # ... with 30 more rows</span></span></code></pre></div>
<p>Note that there is a column corresponding to <code>top_counts</code> which is really useful in case you, let’s say, want to plot these counts. But this column is of <code>character</code> type and in wide format. The solution is to use an additional argument provided for this function:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co"># for reproducibility</span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ggplot2)</span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(magrittr)</span>
<span id="cb10-5"><a href="#cb10-5"></a></span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="kw"><a href="https://rdrr.io/r/base/options.html">options</a></span>(<span class="dt">tibble.width =</span> <span class="ot">Inf</span>) <span class="co"># show me all columns</span></span>
<span id="cb10-7"><a href="#cb10-7"></a></span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="co"># dataframe with counts</span></span>
<span id="cb10-9"><a href="#cb10-9"></a>(df &lt;-<span class="st"> </span>groupedstats<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/groupedstats//reference/grouped_summary.html">grouped_summary</a></span>(</span>
<span id="cb10-10"><a href="#cb10-10"></a>  <span class="dt">data =</span> ggplot2<span class="op">::</span>diamonds,</span>
<span id="cb10-11"><a href="#cb10-11"></a>  <span class="dt">grouping.vars =</span> cut, <span class="co"># for simplicity, let's just use one grouping variable</span></span>
<span id="cb10-12"><a href="#cb10-12"></a>  <span class="dt">measures =</span> color,</span>
<span id="cb10-13"><a href="#cb10-13"></a>  <span class="dt">measures.type =</span> <span class="st">"factor"</span>,</span>
<span id="cb10-14"><a href="#cb10-14"></a>  <span class="dt">topcount.long =</span> <span class="ot">TRUE</span></span>
<span id="cb10-15"><a href="#cb10-15"></a>))</span>
<span id="cb10-16"><a href="#cb10-16"></a><span class="co">#&gt; # A tibble: 20 x 3</span></span>
<span id="cb10-17"><a href="#cb10-17"></a><span class="co">#&gt;    cut       factor.level count</span></span>
<span id="cb10-18"><a href="#cb10-18"></a><span class="co">#&gt;    &lt;ord&gt;     &lt;chr&gt;        &lt;int&gt;</span></span>
<span id="cb10-19"><a href="#cb10-19"></a><span class="co">#&gt;  1 Fair      G              314</span></span>
<span id="cb10-20"><a href="#cb10-20"></a><span class="co">#&gt;  2 Fair      F              312</span></span>
<span id="cb10-21"><a href="#cb10-21"></a><span class="co">#&gt;  3 Fair      H              303</span></span>
<span id="cb10-22"><a href="#cb10-22"></a><span class="co">#&gt;  4 Fair      E              224</span></span>
<span id="cb10-23"><a href="#cb10-23"></a><span class="co">#&gt;  5 Good      E              933</span></span>
<span id="cb10-24"><a href="#cb10-24"></a><span class="co">#&gt;  6 Good      F              909</span></span>
<span id="cb10-25"><a href="#cb10-25"></a><span class="co">#&gt;  7 Good      G              871</span></span>
<span id="cb10-26"><a href="#cb10-26"></a><span class="co">#&gt;  8 Good      H              702</span></span>
<span id="cb10-27"><a href="#cb10-27"></a><span class="co">#&gt;  9 Very Good E             2400</span></span>
<span id="cb10-28"><a href="#cb10-28"></a><span class="co">#&gt; 10 Very Good G             2299</span></span>
<span id="cb10-29"><a href="#cb10-29"></a><span class="co">#&gt; 11 Very Good F             2164</span></span>
<span id="cb10-30"><a href="#cb10-30"></a><span class="co">#&gt; 12 Very Good H             1824</span></span>
<span id="cb10-31"><a href="#cb10-31"></a><span class="co">#&gt; 13 Premium   G             2924</span></span>
<span id="cb10-32"><a href="#cb10-32"></a><span class="co">#&gt; 14 Premium   H             2360</span></span>
<span id="cb10-33"><a href="#cb10-33"></a><span class="co">#&gt; 15 Premium   E             2337</span></span>
<span id="cb10-34"><a href="#cb10-34"></a><span class="co">#&gt; 16 Premium   F             2331</span></span>
<span id="cb10-35"><a href="#cb10-35"></a><span class="co">#&gt; 17 Ideal     G             4884</span></span>
<span id="cb10-36"><a href="#cb10-36"></a><span class="co">#&gt; 18 Ideal     E             3903</span></span>
<span id="cb10-37"><a href="#cb10-37"></a><span class="co">#&gt; 19 Ideal     F             3826</span></span>
<span id="cb10-38"><a href="#cb10-38"></a><span class="co">#&gt; 20 Ideal     H             3115</span></span>
<span id="cb10-39"><a href="#cb10-39"></a></span>
<span id="cb10-40"><a href="#cb10-40"></a><span class="co"># plot</span></span>
<span id="cb10-41"><a href="#cb10-41"></a>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(</span>
<span id="cb10-42"><a href="#cb10-42"></a>  <span class="dt">data =</span> df,</span>
<span id="cb10-43"><a href="#cb10-43"></a>  <span class="dt">mapping =</span> ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(</span>
<span id="cb10-44"><a href="#cb10-44"></a>    <span class="dt">x =</span> forcats<span class="op">::</span><span class="kw"><a href="https://forcats.tidyverse.org/reference/fct_inorder.html">fct_inorder</a></span>(<span class="dt">f =</span> factor.level),</span>
<span id="cb10-45"><a href="#cb10-45"></a>    <span class="dt">y =</span> count,</span>
<span id="cb10-46"><a href="#cb10-46"></a>    <span class="dt">fill =</span> factor.level</span>
<span id="cb10-47"><a href="#cb10-47"></a>  )</span>
<span id="cb10-48"><a href="#cb10-48"></a>) <span class="op">+</span></span>
<span id="cb10-49"><a href="#cb10-49"></a><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span>(<span class="dt">stat =</span> <span class="st">"identity"</span>) <span class="op">+</span></span>
<span id="cb10-50"><a href="#cb10-50"></a><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">x =</span> <span class="st">"color"</span>, <span class="dt">y =</span> <span class="st">"count"</span>) <span class="op">+</span></span>
<span id="cb10-51"><a href="#cb10-51"></a><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span>(<span class="dt">facets =</span> <span class="op">~</span>cut) <span class="op">+</span><span class="st"> </span><span class="co"># for each level of the factor level</span></span>
<span id="cb10-52"><a href="#cb10-52"></a><span class="st">  </span>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/theme_ggstatsplot.html">theme_ggstatsplot</a></span>() <span class="op">+</span></span>
<span id="cb10-53"><a href="#cb10-53"></a><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="dt">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb10-54"><a href="#cb10-54"></a><span class="co">#&gt; Registered S3 methods overwritten by 'car':</span></span>
<span id="cb10-55"><a href="#cb10-55"></a><span class="co">#&gt;   method                          from</span></span>
<span id="cb10-56"><a href="#cb10-56"></a><span class="co">#&gt;   influence.merMod                lme4</span></span>
<span id="cb10-57"><a href="#cb10-57"></a><span class="co">#&gt;   cooks.distance.influence.merMod lme4</span></span>
<span id="cb10-58"><a href="#cb10-58"></a><span class="co">#&gt;   dfbeta.influence.merMod         lme4</span></span>
<span id="cb10-59"><a href="#cb10-59"></a><span class="co">#&gt;   dfbetas.influence.merMod        lme4</span></span></code></pre></div>
<p><img src="reference/figures/README-grouped_summary3-1.png" width="100%"></p>
<p>This produces a long format table with two new columns <code>factor.level</code> and its corresponding <code>count</code>, which can then be immediately fed into other pipelines, e.g., preparing a plot of <code>mean</code> and <code>sd</code> values in <code>ggplot2</code>).</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co"># for reproducibility</span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="kw"><a href="https://rdrr.io/r/base/options.html">options</a></span>(<span class="dt">tibble.width =</span> <span class="ot">Inf</span>) <span class="co"># show me all columns</span></span>
<span id="cb11-4"><a href="#cb11-4"></a></span>
<span id="cb11-5"><a href="#cb11-5"></a>groupedstats<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/groupedstats//reference/grouped_summary.html">grouped_summary</a></span>(</span>
<span id="cb11-6"><a href="#cb11-6"></a>  <span class="dt">data =</span> ggplot2<span class="op">::</span>diamonds,</span>
<span id="cb11-7"><a href="#cb11-7"></a>  <span class="dt">grouping.vars =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(cut, clarity)</span>
<span id="cb11-8"><a href="#cb11-8"></a>)</span>
<span id="cb11-9"><a href="#cb11-9"></a><span class="co">#&gt; # A tibble: 280 x 17</span></span>
<span id="cb11-10"><a href="#cb11-10"></a><span class="co">#&gt;    cut   clarity skim_type variable missing complete    mean       sd    min</span></span>
<span id="cb11-11"><a href="#cb11-11"></a><span class="co">#&gt;    &lt;ord&gt; &lt;ord&gt;   &lt;chr&gt;     &lt;chr&gt;      &lt;int&gt;    &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span id="cb11-12"><a href="#cb11-12"></a><span class="co">#&gt;  1 Fair  I1      numeric   carat          0        1    1.36    0.745   0.34</span></span>
<span id="cb11-13"><a href="#cb11-13"></a><span class="co">#&gt;  2 Fair  I1      numeric   depth          0        1   65.7     3.10   55.6 </span></span>
<span id="cb11-14"><a href="#cb11-14"></a><span class="co">#&gt;  3 Fair  I1      numeric   table          0        1   58.1     2.87   52   </span></span>
<span id="cb11-15"><a href="#cb11-15"></a><span class="co">#&gt;  4 Fair  I1      numeric   price          0        1 3704.   3099.    584   </span></span>
<span id="cb11-16"><a href="#cb11-16"></a><span class="co">#&gt;  5 Fair  I1      numeric   x              0        1    6.72    1.11    4.72</span></span>
<span id="cb11-17"><a href="#cb11-17"></a><span class="co">#&gt;  6 Fair  I1      numeric   y              0        1    6.62    1.13    4.6 </span></span>
<span id="cb11-18"><a href="#cb11-18"></a><span class="co">#&gt;  7 Fair  I1      numeric   z              0        1    4.39    0.756   2.6 </span></span>
<span id="cb11-19"><a href="#cb11-19"></a><span class="co">#&gt;  8 Fair  SI2     numeric   carat          0        1    1.20    0.501   0.25</span></span>
<span id="cb11-20"><a href="#cb11-20"></a><span class="co">#&gt;  9 Fair  SI2     numeric   depth          0        1   64.4     3.16   53.1 </span></span>
<span id="cb11-21"><a href="#cb11-21"></a><span class="co">#&gt; 10 Fair  SI2     numeric   table          0        1   58.8     3.68   50.1 </span></span>
<span id="cb11-22"><a href="#cb11-22"></a><span class="co">#&gt;        p25  median     p75      max     n std.error mean.conf.low mean.conf.high</span></span>
<span id="cb11-23"><a href="#cb11-23"></a><span class="co">#&gt;      &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt; &lt;int&gt;     &lt;dbl&gt;         &lt;dbl&gt;          &lt;dbl&gt;</span></span>
<span id="cb11-24"><a href="#cb11-24"></a><span class="co">#&gt;  1    0.85    1.06    1.82     5.01   210    0.0514          1.26           1.46</span></span>
<span id="cb11-25"><a href="#cb11-25"></a><span class="co">#&gt;  2   64.7    66.0    67.3     78.2    210    0.214          65.3           66.1 </span></span>
<span id="cb11-26"><a href="#cb11-26"></a><span class="co">#&gt;  3   56      58      59       67      210    0.198          57.7           58.5 </span></span>
<span id="cb11-27"><a href="#cb11-27"></a><span class="co">#&gt;  4 1387.   2397    5614.   18531      210  214.           3282.          4125.  </span></span>
<span id="cb11-28"><a href="#cb11-28"></a><span class="co">#&gt;  5    5.96    6.56    7.46    10.7    210    0.0769          6.57           6.87</span></span>
<span id="cb11-29"><a href="#cb11-29"></a><span class="co">#&gt;  6    5.82    6.42    7.38    10.5    210    0.0777          6.47           6.78</span></span>
<span id="cb11-30"><a href="#cb11-30"></a><span class="co">#&gt;  7    3.77    4.22    4.86     6.98   210    0.0522          4.28           4.49</span></span>
<span id="cb11-31"><a href="#cb11-31"></a><span class="co">#&gt;  8    0.9     1.01    1.5      3.01   466    0.0232          1.16           1.25</span></span>
<span id="cb11-32"><a href="#cb11-32"></a><span class="co">#&gt;  9   64.5    65.1    65.9     72.2    466    0.147          64.1           64.7 </span></span>
<span id="cb11-33"><a href="#cb11-33"></a><span class="co">#&gt; 10   56      58      60       79      466    0.171          58.5           59.2 </span></span>
<span id="cb11-34"><a href="#cb11-34"></a><span class="co">#&gt; # ... with 270 more rows</span></span></code></pre></div>
<p>The function should also work with labeled data.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co"># for reproducibility</span></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(labelled)</span>
<span id="cb12-4"><a href="#cb12-4"></a></span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="co"># dataframe</span></span>
<span id="cb12-6"><a href="#cb12-6"></a>df &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(</span>
<span id="cb12-7"><a href="#cb12-7"></a>  <span class="dt">x =</span> <span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"A"</span>, <span class="st">"B"</span>), <span class="dt">each =</span> <span class="dv">50</span>),</span>
<span id="cb12-8"><a href="#cb12-8"></a>  <span class="dt">y =</span> <span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="dv">100</span>), <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span></span>
<span id="cb12-9"><a href="#cb12-9"></a>)</span>
<span id="cb12-10"><a href="#cb12-10"></a></span>
<span id="cb12-11"><a href="#cb12-11"></a><span class="co"># labelled</span></span>
<span id="cb12-12"><a href="#cb12-12"></a>df<span class="op">$</span>y &lt;-<span class="st"> </span><span class="kw">labelled</span>(df<span class="op">$</span>y, <span class="dt">label =</span> <span class="st">"Y variable"</span>, <span class="dt">labels =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>())</span>
<span id="cb12-13"><a href="#cb12-13"></a></span>
<span id="cb12-14"><a href="#cb12-14"></a><span class="co"># convert to a tibble</span></span>
<span id="cb12-15"><a href="#cb12-15"></a>(df &lt;-<span class="st"> </span>tibble<span class="op">::</span><span class="kw"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span>(df))</span>
<span id="cb12-16"><a href="#cb12-16"></a><span class="co">#&gt; # A tibble: 100 x 2</span></span>
<span id="cb12-17"><a href="#cb12-17"></a><span class="co">#&gt;    x             y</span></span>
<span id="cb12-18"><a href="#cb12-18"></a><span class="co">#&gt;    &lt;chr&gt; &lt;dbl+lbl&gt;</span></span>
<span id="cb12-19"><a href="#cb12-19"></a><span class="co">#&gt;  1 A       -0.560 </span></span>
<span id="cb12-20"><a href="#cb12-20"></a><span class="co">#&gt;  2 A       -0.230 </span></span>
<span id="cb12-21"><a href="#cb12-21"></a><span class="co">#&gt;  3 A        1.56  </span></span>
<span id="cb12-22"><a href="#cb12-22"></a><span class="co">#&gt;  4 A        0.0705</span></span>
<span id="cb12-23"><a href="#cb12-23"></a><span class="co">#&gt;  5 A        0.129 </span></span>
<span id="cb12-24"><a href="#cb12-24"></a><span class="co">#&gt;  6 A        1.72  </span></span>
<span id="cb12-25"><a href="#cb12-25"></a><span class="co">#&gt;  7 A        0.461 </span></span>
<span id="cb12-26"><a href="#cb12-26"></a><span class="co">#&gt;  8 A       -1.27  </span></span>
<span id="cb12-27"><a href="#cb12-27"></a><span class="co">#&gt;  9 A       -0.687 </span></span>
<span id="cb12-28"><a href="#cb12-28"></a><span class="co">#&gt; 10 A       -0.446 </span></span>
<span id="cb12-29"><a href="#cb12-29"></a><span class="co">#&gt; # ... with 90 more rows</span></span>
<span id="cb12-30"><a href="#cb12-30"></a></span>
<span id="cb12-31"><a href="#cb12-31"></a><span class="co"># grouped summary</span></span>
<span id="cb12-32"><a href="#cb12-32"></a>groupedstats<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/groupedstats//reference/grouped_summary.html">grouped_summary</a></span>(df, x, y)</span>
<span id="cb12-33"><a href="#cb12-33"></a><span class="co">#&gt; # A tibble: 2 x 16</span></span>
<span id="cb12-34"><a href="#cb12-34"></a><span class="co">#&gt;   x     skim_type variable missing complete   mean    sd   min    p25  median</span></span>
<span id="cb12-35"><a href="#cb12-35"></a><span class="co">#&gt;   &lt;fct&gt; &lt;chr&gt;     &lt;chr&gt;      &lt;int&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span id="cb12-36"><a href="#cb12-36"></a><span class="co">#&gt; 1 A     numeric   y              0        1 0.0344 0.926 -1.97 -0.559 -0.0726</span></span>
<span id="cb12-37"><a href="#cb12-37"></a><span class="co">#&gt; 2 B     numeric   y              0        1 0.146  0.905 -2.31 -0.361  0.153 </span></span>
<span id="cb12-38"><a href="#cb12-38"></a><span class="co">#&gt;     p75   max     n std.error mean.conf.low mean.conf.high</span></span>
<span id="cb12-39"><a href="#cb12-39"></a><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;     &lt;dbl&gt;         &lt;dbl&gt;          &lt;dbl&gt;</span></span>
<span id="cb12-40"><a href="#cb12-40"></a><span class="co">#&gt; 1 0.698  2.17    50     0.131        -0.229          0.298</span></span>
<span id="cb12-41"><a href="#cb12-41"></a><span class="co">#&gt; 2 0.629  2.19    50     0.128        -0.111          0.404</span></span></code></pre></div>
</div>
<div id="grouped_slr" class="section level2">
<h2 class="hasAnchor">
<a href="#grouped_slr" class="anchor"></a><code>grouped_slr</code>
</h2>
<p>This function can be used to run <strong>simple linear regression</strong> (slr) between different pairs of variables across multiple levels of grouping variable(s). For example, we can use the <code>gapminder</code> dataset to study two relationships of interest for <strong>each country</strong> across years:</p>
<ol>
<li>life expectancy and GDP (per capita)</li>
<li>population GDP (per capita) Thus, in this case we have two regression models and one grouping variable with 142 levels (countries)</li>
</ol>
<!-- end list --><div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co"># for reproducibility</span></span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(gapminder)</span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="kw"><a href="https://rdrr.io/r/base/options.html">options</a></span>(<span class="dt">tibble.width =</span> <span class="ot">Inf</span>) <span class="co"># show me all columns</span></span>
<span id="cb13-5"><a href="#cb13-5"></a></span>
<span id="cb13-6"><a href="#cb13-6"></a>groupedstats<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/groupedstats//reference/grouped_slr.html">grouped_slr</a></span>(</span>
<span id="cb13-7"><a href="#cb13-7"></a>  <span class="dt">data =</span> gapminder<span class="op">::</span>gapminder,</span>
<span id="cb13-8"><a href="#cb13-8"></a>  <span class="dt">dep.vars =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(lifeExp, pop),</span>
<span id="cb13-9"><a href="#cb13-9"></a>  <span class="dt">indep.vars =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(gdpPercap, gdpPercap),</span>
<span id="cb13-10"><a href="#cb13-10"></a>  <span class="dt">grouping.vars =</span> country</span>
<span id="cb13-11"><a href="#cb13-11"></a>)</span>
<span id="cb13-12"><a href="#cb13-12"></a><span class="co">#&gt; # A tibble: 284 x 9</span></span>
<span id="cb13-13"><a href="#cb13-13"></a><span class="co">#&gt;    country     formula             t.value estimate conf.low conf.high std.error</span></span>
<span id="cb13-14"><a href="#cb13-14"></a><span class="co">#&gt;    &lt;fct&gt;       &lt;chr&gt;                 &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb13-15"><a href="#cb13-15"></a><span class="co">#&gt;  1 Afghanistan lifeExp ~ gdpPercap  -0.151  -0.0475   -0.751     0.656    0.316 </span></span>
<span id="cb13-16"><a href="#cb13-16"></a><span class="co">#&gt;  2 Albania     lifeExp ~ gdpPercap   4.84    0.837     0.452     1.22     0.173 </span></span>
<span id="cb13-17"><a href="#cb13-17"></a><span class="co">#&gt;  3 Algeria     lifeExp ~ gdpPercap   6.71    0.904     0.604     1.21     0.135 </span></span>
<span id="cb13-18"><a href="#cb13-18"></a><span class="co">#&gt;  4 Angola      lifeExp ~ gdpPercap  -0.998  -0.301    -0.973     0.371    0.302 </span></span>
<span id="cb13-19"><a href="#cb13-19"></a><span class="co">#&gt;  5 Argentina   lifeExp ~ gdpPercap   4.74    0.832     0.440     1.22     0.176 </span></span>
<span id="cb13-20"><a href="#cb13-20"></a><span class="co">#&gt;  6 Australia   lifeExp ~ gdpPercap  19.0     0.986     0.871     1.10     0.0519</span></span>
<span id="cb13-21"><a href="#cb13-21"></a><span class="co">#&gt;  7 Austria     lifeExp ~ gdpPercap  26.5     0.993     0.910     1.08     0.0374</span></span>
<span id="cb13-22"><a href="#cb13-22"></a><span class="co">#&gt;  8 Bahrain     lifeExp ~ gdpPercap   6.45    0.898     0.587     1.21     0.139 </span></span>
<span id="cb13-23"><a href="#cb13-23"></a><span class="co">#&gt;  9 Bangladesh  lifeExp ~ gdpPercap   5.05    0.847     0.473     1.22     0.168 </span></span>
<span id="cb13-24"><a href="#cb13-24"></a><span class="co">#&gt; 10 Belgium     lifeExp ~ gdpPercap  26.1     0.993     0.908     1.08     0.0380</span></span>
<span id="cb13-25"><a href="#cb13-25"></a><span class="co">#&gt;     p.value significance</span></span>
<span id="cb13-26"><a href="#cb13-26"></a><span class="co">#&gt;       &lt;dbl&gt; &lt;chr&gt;       </span></span>
<span id="cb13-27"><a href="#cb13-27"></a><span class="co">#&gt;  1 8.83e- 1 ns          </span></span>
<span id="cb13-28"><a href="#cb13-28"></a><span class="co">#&gt;  2 6.82e- 4 ***         </span></span>
<span id="cb13-29"><a href="#cb13-29"></a><span class="co">#&gt;  3 5.33e- 5 ***         </span></span>
<span id="cb13-30"><a href="#cb13-30"></a><span class="co">#&gt;  4 3.42e- 1 ns          </span></span>
<span id="cb13-31"><a href="#cb13-31"></a><span class="co">#&gt;  5 7.97e- 4 ***         </span></span>
<span id="cb13-32"><a href="#cb13-32"></a><span class="co">#&gt;  6 3.52e- 9 ***         </span></span>
<span id="cb13-33"><a href="#cb13-33"></a><span class="co">#&gt;  7 1.34e-10 ***         </span></span>
<span id="cb13-34"><a href="#cb13-34"></a><span class="co">#&gt;  8 7.38e- 5 ***         </span></span>
<span id="cb13-35"><a href="#cb13-35"></a><span class="co">#&gt;  9 5.03e- 4 ***         </span></span>
<span id="cb13-36"><a href="#cb13-36"></a><span class="co">#&gt; 10 1.56e-10 ***         </span></span>
<span id="cb13-37"><a href="#cb13-37"></a><span class="co">#&gt; # ... with 274 more rows</span></span></code></pre></div>
<p>Notice the order in which the dependent and independent variables are entered; there are two separate regression models being run here: <code>lifeExp ~ gdpPercap</code> and <code>pop ~ gdpPercap</code> If this order is incorrect, the result will also be incorrect. So it is always a good idea to check the <em>formula</em> column to see if you have run the correct linear models. Also, note that the estimates are already standardized, i.e. estimates are standardized regression coefficients (betas, i.e.).</p>
<p>The prior example was with just one grouping variable. This can be done with multiple grouping variables as well. For example, with the <code>diamonds</code> dataset from <code>ggplot2</code> library, let’s assess the relation between carat <em>and</em> price of a diamond for each type of clarity <em>and</em> cut-</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="co"># for reproducibility</span></span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ggplot2)</span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(dplyr)</span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="co">#&gt; </span></span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span id="cb14-7"><a href="#cb14-7"></a><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span id="cb14-8"><a href="#cb14-8"></a><span class="co">#&gt; </span></span>
<span id="cb14-9"><a href="#cb14-9"></a><span class="co">#&gt;     filter, lag</span></span>
<span id="cb14-10"><a href="#cb14-10"></a><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span id="cb14-11"><a href="#cb14-11"></a><span class="co">#&gt; </span></span>
<span id="cb14-12"><a href="#cb14-12"></a><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span id="cb14-13"><a href="#cb14-13"></a><span class="kw"><a href="https://rdrr.io/r/base/options.html">options</a></span>(<span class="dt">tibble.width =</span> <span class="ot">Inf</span>) <span class="co"># show me all columns</span></span>
<span id="cb14-14"><a href="#cb14-14"></a></span>
<span id="cb14-15"><a href="#cb14-15"></a>groupedstats<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/groupedstats//reference/grouped_slr.html">grouped_slr</a></span>(</span>
<span id="cb14-16"><a href="#cb14-16"></a>  <span class="dt">data =</span> ggplot2<span class="op">::</span>diamonds,</span>
<span id="cb14-17"><a href="#cb14-17"></a>  <span class="dt">dep.vars =</span> price,</span>
<span id="cb14-18"><a href="#cb14-18"></a>  <span class="dt">indep.vars =</span> carat,</span>
<span id="cb14-19"><a href="#cb14-19"></a>  <span class="dt">grouping.vars =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(cut, clarity)</span>
<span id="cb14-20"><a href="#cb14-20"></a>) <span class="op">%&gt;%</span></span>
<span id="cb14-21"><a href="#cb14-21"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span>(<span class="dt">.data =</span> ., cut)</span>
<span id="cb14-22"><a href="#cb14-22"></a><span class="co">#&gt; # A tibble: 40 x 10</span></span>
<span id="cb14-23"><a href="#cb14-23"></a><span class="co">#&gt;    cut   clarity formula       t.value estimate conf.low conf.high std.error</span></span>
<span id="cb14-24"><a href="#cb14-24"></a><span class="co">#&gt;    &lt;ord&gt; &lt;ord&gt;   &lt;chr&gt;           &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb14-25"><a href="#cb14-25"></a><span class="co">#&gt;  1 Fair  VS2     price ~ carat   42.0     0.934    0.890     0.978   0.0222 </span></span>
<span id="cb14-26"><a href="#cb14-26"></a><span class="co">#&gt;  2 Fair  SI2     price ~ carat   69.1     0.955    0.928     0.982   0.0138 </span></span>
<span id="cb14-27"><a href="#cb14-27"></a><span class="co">#&gt;  3 Fair  SI1     price ~ carat   58.9     0.946    0.915     0.978   0.0161 </span></span>
<span id="cb14-28"><a href="#cb14-28"></a><span class="co">#&gt;  4 Fair  I1      price ~ carat   58.7     0.971    0.939     1.00    0.0165 </span></span>
<span id="cb14-29"><a href="#cb14-29"></a><span class="co">#&gt;  5 Fair  VVS1    price ~ carat    8.58    0.911    0.685     1.14    0.106  </span></span>
<span id="cb14-30"><a href="#cb14-30"></a><span class="co">#&gt;  6 Fair  VS1     price ~ carat   36.6     0.943    0.892     0.994   0.0257 </span></span>
<span id="cb14-31"><a href="#cb14-31"></a><span class="co">#&gt;  7 Fair  IF      price ~ carat    8.22    0.952    0.678     1.23    0.116  </span></span>
<span id="cb14-32"><a href="#cb14-32"></a><span class="co">#&gt;  8 Fair  VVS2    price ~ carat   13.6     0.857    0.732     0.983   0.0629 </span></span>
<span id="cb14-33"><a href="#cb14-33"></a><span class="co">#&gt;  9 Good  VS1     price ~ carat   74.0     0.946    0.921     0.971   0.0128 </span></span>
<span id="cb14-34"><a href="#cb14-34"></a><span class="co">#&gt; 10 Good  SI2     price ~ carat  103.      0.953    0.934     0.971   0.00926</span></span>
<span id="cb14-35"><a href="#cb14-35"></a><span class="co">#&gt;      p.value significance</span></span>
<span id="cb14-36"><a href="#cb14-36"></a><span class="co">#&gt;        &lt;dbl&gt; &lt;chr&gt;       </span></span>
<span id="cb14-37"><a href="#cb14-37"></a><span class="co">#&gt;  1 1.55e-117 ***         </span></span>
<span id="cb14-38"><a href="#cb14-38"></a><span class="co">#&gt;  2 1.96e-246 ***         </span></span>
<span id="cb14-39"><a href="#cb14-39"></a><span class="co">#&gt;  3 4.58e-201 ***         </span></span>
<span id="cb14-40"><a href="#cb14-40"></a><span class="co">#&gt;  4 1.86e-131 ***         </span></span>
<span id="cb14-41"><a href="#cb14-41"></a><span class="co">#&gt;  5 3.59e-  7 ***         </span></span>
<span id="cb14-42"><a href="#cb14-42"></a><span class="co">#&gt;  6 5.40e- 82 ***         </span></span>
<span id="cb14-43"><a href="#cb14-43"></a><span class="co">#&gt;  7 7.67e-  5 ***         </span></span>
<span id="cb14-44"><a href="#cb14-44"></a><span class="co">#&gt;  8 5.54e- 21 ***         </span></span>
<span id="cb14-45"><a href="#cb14-45"></a><span class="co">#&gt;  9 9.62e-318 ***         </span></span>
<span id="cb14-46"><a href="#cb14-46"></a><span class="co">#&gt; 10 0.        ***         </span></span>
<span id="cb14-47"><a href="#cb14-47"></a><span class="co">#&gt; # ... with 30 more rows</span></span></code></pre></div>
<p>A more general version of this function (<code>grouped_lm</code>) will be implemented in future that will utilize the formula interface of <code><a href="https://rdrr.io/r/stats/lm.html">stats::lm</a></code>.</p>
</div>
<div id="grouped_lm" class="section level2">
<h2 class="hasAnchor">
<a href="#grouped_lm" class="anchor"></a><code>grouped_lm</code>
</h2>
<p>A more general version of simple linear regression is <code><a href="https://rdrr.io/r/stats/lm.html">stats::lm</a></code>, implemented in <code>grouped_lm</code>:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co"># for reproducibility</span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(groupedstats)</span>
<span id="cb15-4"><a href="#cb15-4"></a></span>
<span id="cb15-5"><a href="#cb15-5"></a>groupedstats<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/groupedstats//reference/grouped_lm.html">grouped_lm</a></span>(</span>
<span id="cb15-6"><a href="#cb15-6"></a>  <span class="dt">data =</span> mtcars,</span>
<span id="cb15-7"><a href="#cb15-7"></a>  <span class="dt">grouping.vars =</span> cyl, <span class="co"># grouping variable (just one in this case)</span></span>
<span id="cb15-8"><a href="#cb15-8"></a>  <span class="dt">formula =</span> mpg <span class="op">~</span><span class="st"> </span>am <span class="op">*</span><span class="st"> </span>wt, <span class="co"># note that this function takes a formula</span></span>
<span id="cb15-9"><a href="#cb15-9"></a>  <span class="dt">output =</span> <span class="st">"tidy"</span> <span class="co"># tidy dataframe containing results</span></span>
<span id="cb15-10"><a href="#cb15-10"></a>)</span>
<span id="cb15-11"><a href="#cb15-11"></a><span class="co">#&gt; # A tibble: 12 x 9</span></span>
<span id="cb15-12"><a href="#cb15-12"></a><span class="co">#&gt;      cyl term        estimate std.error statistic   p.value conf.low conf.high</span></span>
<span id="cb15-13"><a href="#cb15-13"></a><span class="co">#&gt;    &lt;dbl&gt; &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb15-14"><a href="#cb15-14"></a><span class="co">#&gt;  1     4 (Intercept)   13.9      16.1      0.865  0.416       -24.1     51.9  </span></span>
<span id="cb15-15"><a href="#cb15-15"></a><span class="co">#&gt;  2     4 am            30.3      17.2      1.77   0.121       -10.3     70.9  </span></span>
<span id="cb15-16"><a href="#cb15-16"></a><span class="co">#&gt;  3     4 wt             3.07      5.44     0.564  0.590        -9.79    15.9  </span></span>
<span id="cb15-17"><a href="#cb15-17"></a><span class="co">#&gt;  4     4 am:wt        -11.0       6.16    -1.78   0.118       -25.5      3.61 </span></span>
<span id="cb15-18"><a href="#cb15-18"></a><span class="co">#&gt;  5     6 (Intercept)   63.6      14.1      4.51   0.0204       18.7    109.   </span></span>
<span id="cb15-19"><a href="#cb15-19"></a><span class="co">#&gt;  6     6 am           -41.4      19.0     -2.18   0.117      -102.      19.1  </span></span>
<span id="cb15-20"><a href="#cb15-20"></a><span class="co">#&gt;  7     6 wt           -13.1       4.16    -3.16   0.0511      -26.4      0.113</span></span>
<span id="cb15-21"><a href="#cb15-21"></a><span class="co">#&gt;  8     6 am:wt         12.5       6.22     2.02   0.137        -7.26    32.4  </span></span>
<span id="cb15-22"><a href="#cb15-22"></a><span class="co">#&gt;  9     8 (Intercept)   25.1       3.51     7.14   0.0000315    17.2     32.9  </span></span>
<span id="cb15-23"><a href="#cb15-23"></a><span class="co">#&gt; 10     8 am            -2.92     25.9     -0.113  0.912       -60.5     54.7  </span></span>
<span id="cb15-24"><a href="#cb15-24"></a><span class="co">#&gt; 11     8 wt            -2.44      0.842   -2.90   0.0159       -4.32    -0.563</span></span>
<span id="cb15-25"><a href="#cb15-25"></a><span class="co">#&gt; 12     8 am:wt          0.439     7.63     0.0575 0.955       -16.6     17.4  </span></span>
<span id="cb15-26"><a href="#cb15-26"></a><span class="co">#&gt;    significance</span></span>
<span id="cb15-27"><a href="#cb15-27"></a><span class="co">#&gt;    &lt;chr&gt;       </span></span>
<span id="cb15-28"><a href="#cb15-28"></a><span class="co">#&gt;  1 ns          </span></span>
<span id="cb15-29"><a href="#cb15-29"></a><span class="co">#&gt;  2 ns          </span></span>
<span id="cb15-30"><a href="#cb15-30"></a><span class="co">#&gt;  3 ns          </span></span>
<span id="cb15-31"><a href="#cb15-31"></a><span class="co">#&gt;  4 ns          </span></span>
<span id="cb15-32"><a href="#cb15-32"></a><span class="co">#&gt;  5 *           </span></span>
<span id="cb15-33"><a href="#cb15-33"></a><span class="co">#&gt;  6 ns          </span></span>
<span id="cb15-34"><a href="#cb15-34"></a><span class="co">#&gt;  7 ns          </span></span>
<span id="cb15-35"><a href="#cb15-35"></a><span class="co">#&gt;  8 ns          </span></span>
<span id="cb15-36"><a href="#cb15-36"></a><span class="co">#&gt;  9 ***         </span></span>
<span id="cb15-37"><a href="#cb15-37"></a><span class="co">#&gt; 10 ns          </span></span>
<span id="cb15-38"><a href="#cb15-38"></a><span class="co">#&gt; 11 *           </span></span>
<span id="cb15-39"><a href="#cb15-39"></a><span class="co">#&gt; 12 ns</span></span></code></pre></div>
<p>The same function can also be used to get model summaries instead of a tidy dataframe containing results-</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="co"># for reproducibility</span></span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(groupedstats)</span>
<span id="cb16-4"><a href="#cb16-4"></a></span>
<span id="cb16-5"><a href="#cb16-5"></a>groupedstats<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/groupedstats//reference/grouped_lm.html">grouped_lm</a></span>(</span>
<span id="cb16-6"><a href="#cb16-6"></a>  <span class="dt">data =</span> ggplot2<span class="op">::</span>diamonds,</span>
<span id="cb16-7"><a href="#cb16-7"></a>  <span class="dt">grouping.vars =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(cut, color), <span class="co"># grouping variables</span></span>
<span id="cb16-8"><a href="#cb16-8"></a>  <span class="dt">formula =</span> price <span class="op">~</span><span class="st"> </span>carat <span class="op">*</span><span class="st"> </span>clarity, <span class="co"># formula</span></span>
<span id="cb16-9"><a href="#cb16-9"></a>  <span class="dt">output =</span> <span class="st">"glance"</span> <span class="co"># dataframe with model summaries</span></span>
<span id="cb16-10"><a href="#cb16-10"></a>)</span>
<span id="cb16-11"><a href="#cb16-11"></a><span class="co">#&gt; # A tibble: 35 x 14</span></span>
<span id="cb16-12"><a href="#cb16-12"></a><span class="co">#&gt;    cut   color r.squared adj.r.squared sigma statistic   p.value    df logLik</span></span>
<span id="cb16-13"><a href="#cb16-13"></a><span class="co">#&gt;    &lt;ord&gt; &lt;ord&gt;     &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span id="cb16-14"><a href="#cb16-14"></a><span class="co">#&gt;  1 Fair  D         0.915         0.906 1005.      106. 1.03e- 70    15 -1350.</span></span>
<span id="cb16-15"><a href="#cb16-15"></a><span class="co">#&gt;  2 Fair  E         0.917         0.912  883.      179. 8.70e-106    13 -1830.</span></span>
<span id="cb16-16"><a href="#cb16-16"></a><span class="co">#&gt;  3 Fair  F         0.917         0.912  954.      217. 9.37e-150    15 -2575.</span></span>
<span id="cb16-17"><a href="#cb16-17"></a><span class="co">#&gt;  4 Fair  G         0.932         0.929  964.      273. 5.03e-164    15 -2595.</span></span>
<span id="cb16-18"><a href="#cb16-18"></a><span class="co">#&gt;  5 Fair  H         0.932         0.929 1033.      332. 1.76e-161    12 -2526.</span></span>
<span id="cb16-19"><a href="#cb16-19"></a><span class="co">#&gt;  6 Fair  I         0.958         0.955  794.      307. 1.14e-104    12 -1410.</span></span>
<span id="cb16-20"><a href="#cb16-20"></a><span class="co">#&gt;  7 Fair  J         0.955         0.950  907.      204. 1.82e- 66    11  -973.</span></span>
<span id="cb16-21"><a href="#cb16-21"></a><span class="co">#&gt;  8 Good  D         0.933         0.931  831.      600. 0.           15 -5382.</span></span>
<span id="cb16-22"><a href="#cb16-22"></a><span class="co">#&gt;  9 Good  E         0.927         0.926  905.      781. 0.           15 -7667.</span></span>
<span id="cb16-23"><a href="#cb16-23"></a><span class="co">#&gt; 10 Good  F         0.915         0.914  939.      644. 0.           15 -7504.</span></span>
<span id="cb16-24"><a href="#cb16-24"></a><span class="co">#&gt;       AIC    BIC   deviance df.residual  nobs</span></span>
<span id="cb16-25"><a href="#cb16-25"></a><span class="co">#&gt;     &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb16-26"><a href="#cb16-26"></a><span class="co">#&gt;  1  2733.  2786. 148463951.         147   163</span></span>
<span id="cb16-27"><a href="#cb16-27"></a><span class="co">#&gt;  2  3690.  3741. 163677866.         210   224</span></span>
<span id="cb16-28"><a href="#cb16-28"></a><span class="co">#&gt;  3  5184.  5248. 269389292.         296   312</span></span>
<span id="cb16-29"><a href="#cb16-29"></a><span class="co">#&gt;  4  5224.  5288. 277025077.         298   314</span></span>
<span id="cb16-30"><a href="#cb16-30"></a><span class="co">#&gt;  5  5081.  5133. 309753202.         290   303</span></span>
<span id="cb16-31"><a href="#cb16-31"></a><span class="co">#&gt;  6  2848.  2892. 102049583.         162   175</span></span>
<span id="cb16-32"><a href="#cb16-32"></a><span class="co">#&gt;  7  1972.  2008.  88046170.         107   119</span></span>
<span id="cb16-33"><a href="#cb16-33"></a><span class="co">#&gt;  8 10797. 10874. 446239835.         646   662</span></span>
<span id="cb16-34"><a href="#cb16-34"></a><span class="co">#&gt;  9 15369. 15451. 750592238.         917   933</span></span>
<span id="cb16-35"><a href="#cb16-35"></a><span class="co">#&gt; 10 15042. 15123. 787519475.         893   909</span></span>
<span id="cb16-36"><a href="#cb16-36"></a><span class="co">#&gt; # ... with 25 more rows</span></span></code></pre></div>
</div>
<div id="grouped_aov" class="section level2">
<h2 class="hasAnchor">
<a href="#grouped_aov" class="anchor"></a><code>grouped_aov</code>
</h2>
<p>A related function to <code><a href="https://rdrr.io/r/stats/lm.html">stats::lm</a></code> is <code><a href="https://rdrr.io/r/stats/aov.html">stats::aov</a></code>, which fits an analysis of variance model for each group. Contrast the output you get here with the previous output for the same model from <code>grouped_lm</code> function. The estimate in this case with be an effect size (either partial eta-squared or partial omega-squared).</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co"># for reproducibility</span></span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(groupedstats)</span>
<span id="cb17-4"><a href="#cb17-4"></a></span>
<span id="cb17-5"><a href="#cb17-5"></a>groupedstats<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/groupedstats//reference/grouped_aov.html">grouped_aov</a></span>(</span>
<span id="cb17-6"><a href="#cb17-6"></a>  <span class="dt">data =</span> mtcars,</span>
<span id="cb17-7"><a href="#cb17-7"></a>  <span class="dt">grouping.vars =</span> cyl, <span class="co"># grouping variable (just one in this case)</span></span>
<span id="cb17-8"><a href="#cb17-8"></a>  <span class="dt">formula =</span> mpg <span class="op">~</span><span class="st"> </span>am <span class="op">*</span><span class="st"> </span>wt, <span class="co"># note that this function takes a formula</span></span>
<span id="cb17-9"><a href="#cb17-9"></a>  <span class="dt">output =</span> <span class="st">"tidy"</span> <span class="co"># tidy dataframe with results</span></span>
<span id="cb17-10"><a href="#cb17-10"></a>)</span>
<span id="cb17-11"><a href="#cb17-11"></a><span class="co">#&gt; # A tibble: 9 x 10</span></span>
<span id="cb17-12"><a href="#cb17-12"></a><span class="co">#&gt;     cyl term  F.value   df1   df2 p.value partial.etasq conf.low conf.high</span></span>
<span id="cb17-13"><a href="#cb17-13"></a><span class="co">#&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;         &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb17-14"><a href="#cb17-14"></a><span class="co">#&gt; 1     6 am    5.07        1     3  0.110       0.628      0         0.820 </span></span>
<span id="cb17-15"><a href="#cb17-15"></a><span class="co">#&gt; 2     6 wt    5.91        1     3  0.0933      0.663      0         0.835 </span></span>
<span id="cb17-16"><a href="#cb17-16"></a><span class="co">#&gt; 3     6 am:wt 4.06        1     3  0.137       0.575      0         0.796 </span></span>
<span id="cb17-17"><a href="#cb17-17"></a><span class="co">#&gt; 4     4 am    5.95        1     7  0.0448      0.459      0         0.711 </span></span>
<span id="cb17-18"><a href="#cb17-18"></a><span class="co">#&gt; 5     4 wt    4.59        1     7  0.0693      0.396      0         0.676 </span></span>
<span id="cb17-19"><a href="#cb17-19"></a><span class="co">#&gt; 6     4 am:wt 3.17        1     7  0.118       0.311      0         0.627 </span></span>
<span id="cb17-20"><a href="#cb17-20"></a><span class="co">#&gt; 7     8 am    0.0456      1    10  0.835       0.00454    0         0.242 </span></span>
<span id="cb17-21"><a href="#cb17-21"></a><span class="co">#&gt; 8     8 wt    8.45        1    10  0.0156      0.458      0.0190    0.691 </span></span>
<span id="cb17-22"><a href="#cb17-22"></a><span class="co">#&gt; 9     8 am:wt 0.00331     1    10  0.955       0.000330   0         0.0885</span></span>
<span id="cb17-23"><a href="#cb17-23"></a><span class="co">#&gt;   significance</span></span>
<span id="cb17-24"><a href="#cb17-24"></a><span class="co">#&gt;   &lt;chr&gt;       </span></span>
<span id="cb17-25"><a href="#cb17-25"></a><span class="co">#&gt; 1 ns          </span></span>
<span id="cb17-26"><a href="#cb17-26"></a><span class="co">#&gt; 2 ns          </span></span>
<span id="cb17-27"><a href="#cb17-27"></a><span class="co">#&gt; 3 ns          </span></span>
<span id="cb17-28"><a href="#cb17-28"></a><span class="co">#&gt; 4 *           </span></span>
<span id="cb17-29"><a href="#cb17-29"></a><span class="co">#&gt; 5 ns          </span></span>
<span id="cb17-30"><a href="#cb17-30"></a><span class="co">#&gt; 6 ns          </span></span>
<span id="cb17-31"><a href="#cb17-31"></a><span class="co">#&gt; 7 ns          </span></span>
<span id="cb17-32"><a href="#cb17-32"></a><span class="co">#&gt; 8 *           </span></span>
<span id="cb17-33"><a href="#cb17-33"></a><span class="co">#&gt; 9 ns</span></span></code></pre></div>
<p>The same function can also be used to compute Tukey’s test of Honest Significant Differences (HSD). For example, we can check for differences in life expectancy between different continents for all years for which the gapminder survey was conducted:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="co"># for reproducibility</span></span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(groupedstats)</span>
<span id="cb18-4"><a href="#cb18-4"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(gapminder)</span>
<span id="cb18-5"><a href="#cb18-5"></a></span>
<span id="cb18-6"><a href="#cb18-6"></a>groupedstats<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/groupedstats//reference/grouped_aov.html">grouped_aov</a></span>(</span>
<span id="cb18-7"><a href="#cb18-7"></a>  <span class="dt">data =</span> gapminder<span class="op">::</span>gapminder,</span>
<span id="cb18-8"><a href="#cb18-8"></a>  <span class="dt">grouping.vars =</span> year,</span>
<span id="cb18-9"><a href="#cb18-9"></a>  <span class="dt">formula =</span> lifeExp <span class="op">~</span><span class="st"> </span>continent,</span>
<span id="cb18-10"><a href="#cb18-10"></a>  <span class="dt">output =</span> <span class="st">"tukey"</span></span>
<span id="cb18-11"><a href="#cb18-11"></a>)</span>
<span id="cb18-12"><a href="#cb18-12"></a><span class="co">#&gt; Note: The p-value is adjusted for the number of tests conducted</span></span>
<span id="cb18-13"><a href="#cb18-13"></a><span class="co">#&gt;             at each level of the grouping variable.</span></span>
<span id="cb18-14"><a href="#cb18-14"></a><span class="co">#&gt; # A tibble: 120 x 8</span></span>
<span id="cb18-15"><a href="#cb18-15"></a><span class="co">#&gt;     year term      comparison       estimate conf.low conf.high adj.p.value</span></span>
<span id="cb18-16"><a href="#cb18-16"></a><span class="co">#&gt;    &lt;int&gt; &lt;chr&gt;     &lt;chr&gt;               &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;</span></span>
<span id="cb18-17"><a href="#cb18-17"></a><span class="co">#&gt;  1  1952 continent Americas-Africa     14.1      9.21     19.1     7.35e-12</span></span>
<span id="cb18-18"><a href="#cb18-18"></a><span class="co">#&gt;  2  1952 continent Asia-Africa          7.18     2.66     11.7     2.11e- 4</span></span>
<span id="cb18-19"><a href="#cb18-19"></a><span class="co">#&gt;  3  1952 continent Europe-Africa       25.3     20.6      29.9     1.01e-14</span></span>
<span id="cb18-20"><a href="#cb18-20"></a><span class="co">#&gt;  4  1952 continent Oceania-Africa      30.1     15.5      44.7     7.12e- 7</span></span>
<span id="cb18-21"><a href="#cb18-21"></a><span class="co">#&gt;  5  1952 continent Asia-Americas       -6.97   -12.3      -1.59    4.28e- 3</span></span>
<span id="cb18-22"><a href="#cb18-22"></a><span class="co">#&gt;  6  1952 continent Europe-Americas     11.1      5.64     16.6     1.12e- 6</span></span>
<span id="cb18-23"><a href="#cb18-23"></a><span class="co">#&gt;  7  1952 continent Oceania-Americas    16.0      1.07     30.9     2.91e- 2</span></span>
<span id="cb18-24"><a href="#cb18-24"></a><span class="co">#&gt;  8  1952 continent Europe-Asia         18.1     13.0      23.2     5.87e-14</span></span>
<span id="cb18-25"><a href="#cb18-25"></a><span class="co">#&gt;  9  1952 continent Oceania-Asia        22.9      8.17     37.7     3.16e- 4</span></span>
<span id="cb18-26"><a href="#cb18-26"></a><span class="co">#&gt; 10  1952 continent Oceania-Europe       4.85    -9.97     19.7     8.95e- 1</span></span>
<span id="cb18-27"><a href="#cb18-27"></a><span class="co">#&gt;    significance</span></span>
<span id="cb18-28"><a href="#cb18-28"></a><span class="co">#&gt;    &lt;chr&gt;       </span></span>
<span id="cb18-29"><a href="#cb18-29"></a><span class="co">#&gt;  1 ***         </span></span>
<span id="cb18-30"><a href="#cb18-30"></a><span class="co">#&gt;  2 ***         </span></span>
<span id="cb18-31"><a href="#cb18-31"></a><span class="co">#&gt;  3 ***         </span></span>
<span id="cb18-32"><a href="#cb18-32"></a><span class="co">#&gt;  4 ***         </span></span>
<span id="cb18-33"><a href="#cb18-33"></a><span class="co">#&gt;  5 **          </span></span>
<span id="cb18-34"><a href="#cb18-34"></a><span class="co">#&gt;  6 ***         </span></span>
<span id="cb18-35"><a href="#cb18-35"></a><span class="co">#&gt;  7 *           </span></span>
<span id="cb18-36"><a href="#cb18-36"></a><span class="co">#&gt;  8 ***         </span></span>
<span id="cb18-37"><a href="#cb18-37"></a><span class="co">#&gt;  9 ***         </span></span>
<span id="cb18-38"><a href="#cb18-38"></a><span class="co">#&gt; 10 ns          </span></span>
<span id="cb18-39"><a href="#cb18-39"></a><span class="co">#&gt; # ... with 110 more rows</span></span></code></pre></div>
<p>Note that the p-value is adjusted adjusted for the number of tests conducted at each level of the grouping variable, and not across all tests conducted.</p>
</div>
<div id="grouped_glm" class="section level2">
<h2 class="hasAnchor">
<a href="#grouped_glm" class="anchor"></a><code>grouped_glm</code>
</h2>
<p>The option to run generalized linear model (<code><a href="https://rdrr.io/r/stats/glm.html">stats::glm</a></code>) across different levels of the grouping variable is also implemented similarly-</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="co"># for reproducibility</span></span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb19-3"><a href="#cb19-3"></a></span>
<span id="cb19-4"><a href="#cb19-4"></a>groupedstats<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/groupedstats//reference/grouped_glm.html">grouped_glm</a></span>(</span>
<span id="cb19-5"><a href="#cb19-5"></a>  <span class="dt">data =</span> ggstatsplot<span class="op">::</span>Titanic_full,</span>
<span id="cb19-6"><a href="#cb19-6"></a>  <span class="dt">formula =</span> Survived <span class="op">~</span><span class="st"> </span>Sex,</span>
<span id="cb19-7"><a href="#cb19-7"></a>  <span class="dt">grouping.vars =</span> Class,</span>
<span id="cb19-8"><a href="#cb19-8"></a>  <span class="dt">family =</span> stats<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span>(<span class="dt">link =</span> <span class="st">"logit"</span>),</span>
<span id="cb19-9"><a href="#cb19-9"></a>  <span class="dt">output =</span> <span class="st">"tidy"</span></span>
<span id="cb19-10"><a href="#cb19-10"></a>)</span>
<span id="cb19-11"><a href="#cb19-11"></a><span class="co">#&gt; # A tibble: 8 x 9</span></span>
<span id="cb19-12"><a href="#cb19-12"></a><span class="co">#&gt;   Class term        estimate std.error statistic  p.value conf.low conf.high</span></span>
<span id="cb19-13"><a href="#cb19-13"></a><span class="co">#&gt;   &lt;fct&gt; &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb19-14"><a href="#cb19-14"></a><span class="co">#&gt; 1 1st   (Intercept)    3.56      0.507      7.03 2.13e-12    2.70      4.74 </span></span>
<span id="cb19-15"><a href="#cb19-15"></a><span class="co">#&gt; 2 1st   SexMale       -4.21      0.531     -7.92 2.29e-15   -5.42     -3.29 </span></span>
<span id="cb19-16"><a href="#cb19-16"></a><span class="co">#&gt; 3 2nd   (Intercept)    1.97      0.296      6.65 3.03e-11    1.43      2.60 </span></span>
<span id="cb19-17"><a href="#cb19-17"></a><span class="co">#&gt; 4 2nd   SexMale       -3.79      0.366    -10.3  4.88e-25   -4.54     -3.10 </span></span>
<span id="cb19-18"><a href="#cb19-18"></a><span class="co">#&gt; 5 3rd   (Intercept)   -0.164     0.143     -1.14 2.54e- 1   -0.446     0.117</span></span>
<span id="cb19-19"><a href="#cb19-19"></a><span class="co">#&gt; 6 3rd   SexMale       -1.40      0.185     -7.58 3.36e-14   -1.77     -1.04 </span></span>
<span id="cb19-20"><a href="#cb19-20"></a><span class="co">#&gt; 7 Crew  (Intercept)    1.90      0.619      3.06 2.18e- 3    0.827     3.34 </span></span>
<span id="cb19-21"><a href="#cb19-21"></a><span class="co">#&gt; 8 Crew  SexMale       -3.15      0.625     -5.04 4.68e- 7   -4.60     -2.06 </span></span>
<span id="cb19-22"><a href="#cb19-22"></a><span class="co">#&gt;   significance</span></span>
<span id="cb19-23"><a href="#cb19-23"></a><span class="co">#&gt;   &lt;chr&gt;       </span></span>
<span id="cb19-24"><a href="#cb19-24"></a><span class="co">#&gt; 1 ***         </span></span>
<span id="cb19-25"><a href="#cb19-25"></a><span class="co">#&gt; 2 ***         </span></span>
<span id="cb19-26"><a href="#cb19-26"></a><span class="co">#&gt; 3 ***         </span></span>
<span id="cb19-27"><a href="#cb19-27"></a><span class="co">#&gt; 4 ***         </span></span>
<span id="cb19-28"><a href="#cb19-28"></a><span class="co">#&gt; 5 ns          </span></span>
<span id="cb19-29"><a href="#cb19-29"></a><span class="co">#&gt; 6 ***         </span></span>
<span id="cb19-30"><a href="#cb19-30"></a><span class="co">#&gt; 7 **          </span></span>
<span id="cb19-31"><a href="#cb19-31"></a><span class="co">#&gt; 8 ***</span></span></code></pre></div>
<p>Note that the <code>statistic</code> will either be a <code>t</code> (gaussian, e.g.) or a <code>z</code> (binomial, e.g.) value, based on the family of models used.</p>
<p>You can also get a model summary across all models with <code><a href="http://broom.tidyverse.org/reference/reexports.html">broom::glance</a></code> methods-</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="co"># for reproducibility</span></span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb20-3"><a href="#cb20-3"></a></span>
<span id="cb20-4"><a href="#cb20-4"></a>groupedstats<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/groupedstats//reference/grouped_glm.html">grouped_glm</a></span>(</span>
<span id="cb20-5"><a href="#cb20-5"></a>  <span class="dt">data =</span> ggstatsplot<span class="op">::</span>Titanic_full,</span>
<span id="cb20-6"><a href="#cb20-6"></a>  <span class="dt">formula =</span> Survived <span class="op">~</span><span class="st"> </span>Sex,</span>
<span id="cb20-7"><a href="#cb20-7"></a>  <span class="dt">grouping.vars =</span> Class,</span>
<span id="cb20-8"><a href="#cb20-8"></a>  <span class="dt">family =</span> stats<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span>(<span class="dt">link =</span> <span class="st">"logit"</span>),</span>
<span id="cb20-9"><a href="#cb20-9"></a>  <span class="dt">output =</span> <span class="st">"glance"</span></span>
<span id="cb20-10"><a href="#cb20-10"></a>)</span>
<span id="cb20-11"><a href="#cb20-11"></a><span class="co">#&gt; # A tibble: 4 x 9</span></span>
<span id="cb20-12"><a href="#cb20-12"></a><span class="co">#&gt;   Class null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs</span></span>
<span id="cb20-13"><a href="#cb20-13"></a><span class="co">#&gt;   &lt;fct&gt;         &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb20-14"><a href="#cb20-14"></a><span class="co">#&gt; 1 1st            430.     324  -134.  272.  280.     268.         323   325</span></span>
<span id="cb20-15"><a href="#cb20-15"></a><span class="co">#&gt; 2 2nd            387.     284  -112.  228.  235.     224.         283   285</span></span>
<span id="cb20-16"><a href="#cb20-16"></a><span class="co">#&gt; 3 3rd            797.     705  -370.  744.  753.     740.         704   706</span></span>
<span id="cb20-17"><a href="#cb20-17"></a><span class="co">#&gt; 4 Crew           974.     884  -466.  936.  946.     932.         883   885</span></span></code></pre></div>
</div>
<div id="grouped_lmer" class="section level2">
<h2 class="hasAnchor">
<a href="#grouped_lmer" class="anchor"></a><code>grouped_lmer</code>
</h2>
<p>Linear mixed effects analyses (<code><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lme4::lmer</a></code>) for all combinations of grouping variable levels can be carried out using <code>grouped_lmer</code>:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="co"># for reproducibility</span></span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb21-3"><a href="#cb21-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(gapminder)</span>
<span id="cb21-4"><a href="#cb21-4"></a></span>
<span id="cb21-5"><a href="#cb21-5"></a><span class="co"># getting tidy output of results</span></span>
<span id="cb21-6"><a href="#cb21-6"></a>groupedstats<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/groupedstats//reference/grouped_lmer.html">grouped_lmer</a></span>(</span>
<span id="cb21-7"><a href="#cb21-7"></a>  <span class="dt">data =</span> gapminder,</span>
<span id="cb21-8"><a href="#cb21-8"></a>  <span class="dt">formula =</span> <span class="kw"><a href="https://rdrr.io/r/base/scale.html">scale</a></span>(lifeExp) <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/scale.html">scale</a></span>(gdpPercap) <span class="op">+</span><span class="st"> </span>(gdpPercap <span class="op">|</span><span class="st"> </span>continent),</span>
<span id="cb21-9"><a href="#cb21-9"></a>  <span class="dt">grouping.vars =</span> year,</span>
<span id="cb21-10"><a href="#cb21-10"></a>  <span class="dt">REML =</span> <span class="ot">FALSE</span>,</span>
<span id="cb21-11"><a href="#cb21-11"></a>  <span class="dt">output =</span> <span class="st">"tidy"</span></span>
<span id="cb21-12"><a href="#cb21-12"></a>)</span>
<span id="cb21-13"><a href="#cb21-13"></a><span class="co">#&gt; boundary (singular) fit: see ?isSingular</span></span>
<span id="cb21-14"><a href="#cb21-14"></a><span class="co">#&gt; boundary (singular) fit: see ?isSingular</span></span>
<span id="cb21-15"><a href="#cb21-15"></a><span class="co">#&gt; boundary (singular) fit: see ?isSingular</span></span>
<span id="cb21-16"><a href="#cb21-16"></a><span class="co">#&gt; boundary (singular) fit: see ?isSingular</span></span>
<span id="cb21-17"><a href="#cb21-17"></a><span class="co">#&gt; boundary (singular) fit: see ?isSingular</span></span>
<span id="cb21-18"><a href="#cb21-18"></a><span class="co">#&gt; boundary (singular) fit: see ?isSingular</span></span>
<span id="cb21-19"><a href="#cb21-19"></a><span class="co">#&gt; boundary (singular) fit: see ?isSingular</span></span>
<span id="cb21-20"><a href="#cb21-20"></a><span class="co">#&gt; boundary (singular) fit: see ?isSingular</span></span>
<span id="cb21-21"><a href="#cb21-21"></a><span class="co">#&gt; boundary (singular) fit: see ?isSingular</span></span>
<span id="cb21-22"><a href="#cb21-22"></a><span class="co">#&gt; boundary (singular) fit: see ?isSingular</span></span>
<span id="cb21-23"><a href="#cb21-23"></a><span class="co">#&gt; boundary (singular) fit: see ?isSingular</span></span>
<span id="cb21-24"><a href="#cb21-24"></a><span class="co">#&gt; boundary (singular) fit: see ?isSingular</span></span>
<span id="cb21-25"><a href="#cb21-25"></a><span class="co">#&gt; boundary (singular) fit: see ?isSingular</span></span>
<span id="cb21-26"><a href="#cb21-26"></a><span class="co">#&gt; boundary (singular) fit: see ?isSingular</span></span>
<span id="cb21-27"><a href="#cb21-27"></a><span class="co">#&gt; boundary (singular) fit: see ?isSingular</span></span>
<span id="cb21-28"><a href="#cb21-28"></a><span class="co">#&gt; boundary (singular) fit: see ?isSingular</span></span>
<span id="cb21-29"><a href="#cb21-29"></a><span class="co">#&gt; boundary (singular) fit: see ?isSingular</span></span>
<span id="cb21-30"><a href="#cb21-30"></a><span class="co">#&gt; boundary (singular) fit: see ?isSingular</span></span>
<span id="cb21-31"><a href="#cb21-31"></a><span class="co">#&gt; boundary (singular) fit: see ?isSingular</span></span>
<span id="cb21-32"><a href="#cb21-32"></a><span class="co">#&gt; boundary (singular) fit: see ?isSingular</span></span>
<span id="cb21-33"><a href="#cb21-33"></a><span class="co">#&gt; boundary (singular) fit: see ?isSingular</span></span>
<span id="cb21-34"><a href="#cb21-34"></a><span class="co">#&gt; boundary (singular) fit: see ?isSingular</span></span>
<span id="cb21-35"><a href="#cb21-35"></a><span class="co">#&gt; # A tibble: 24 x 10</span></span>
<span id="cb21-36"><a href="#cb21-36"></a><span class="co">#&gt;     year effect term             estimate std.error statistic conf.low conf.high</span></span>
<span id="cb21-37"><a href="#cb21-37"></a><span class="co">#&gt;    &lt;int&gt; &lt;chr&gt;  &lt;chr&gt;               &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb21-38"><a href="#cb21-38"></a><span class="co">#&gt;  1  1952 fixed  (Intercept)         0.201    0.743      0.270  -1.26       1.66 </span></span>
<span id="cb21-39"><a href="#cb21-39"></a><span class="co">#&gt;  2  1952 fixed  scale(gdpPercap)    0.900    0.742      1.21   -0.555      2.35 </span></span>
<span id="cb21-40"><a href="#cb21-40"></a><span class="co">#&gt;  3  1957 fixed  (Intercept)         0.207    0.380      0.545  -0.538      0.952</span></span>
<span id="cb21-41"><a href="#cb21-41"></a><span class="co">#&gt;  4  1957 fixed  scale(gdpPercap)    0.424    0.261      1.62   -0.0878     0.936</span></span>
<span id="cb21-42"><a href="#cb21-42"></a><span class="co">#&gt;  5  1962 fixed  (Intercept)         0.226    0.505      0.447  -0.765      1.22 </span></span>
<span id="cb21-43"><a href="#cb21-43"></a><span class="co">#&gt;  6  1962 fixed  scale(gdpPercap)    0.547    0.273      2.01    0.0130     1.08 </span></span>
<span id="cb21-44"><a href="#cb21-44"></a><span class="co">#&gt;  7  1967 fixed  (Intercept)         0.233    0.308      0.757  -0.370      0.836</span></span>
<span id="cb21-45"><a href="#cb21-45"></a><span class="co">#&gt;  8  1967 fixed  scale(gdpPercap)    0.271    0.0792     3.42    0.115      0.426</span></span>
<span id="cb21-46"><a href="#cb21-46"></a><span class="co">#&gt;  9  1972 fixed  (Intercept)         0.268    0.312      0.859  -0.344      0.881</span></span>
<span id="cb21-47"><a href="#cb21-47"></a><span class="co">#&gt; 10  1972 fixed  scale(gdpPercap)    0.236    0.0582     4.05    0.122      0.350</span></span>
<span id="cb21-48"><a href="#cb21-48"></a><span class="co">#&gt;      p.value significance</span></span>
<span id="cb21-49"><a href="#cb21-49"></a><span class="co">#&gt;        &lt;dbl&gt; &lt;chr&gt;       </span></span>
<span id="cb21-50"><a href="#cb21-50"></a><span class="co">#&gt;  1 0.787     ns          </span></span>
<span id="cb21-51"><a href="#cb21-51"></a><span class="co">#&gt;  2 0.225     ns          </span></span>
<span id="cb21-52"><a href="#cb21-52"></a><span class="co">#&gt;  3 0.586     ns          </span></span>
<span id="cb21-53"><a href="#cb21-53"></a><span class="co">#&gt;  4 0.104     ns          </span></span>
<span id="cb21-54"><a href="#cb21-54"></a><span class="co">#&gt;  5 0.655     ns          </span></span>
<span id="cb21-55"><a href="#cb21-55"></a><span class="co">#&gt;  6 0.0447    *           </span></span>
<span id="cb21-56"><a href="#cb21-56"></a><span class="co">#&gt;  7 0.449     ns          </span></span>
<span id="cb21-57"><a href="#cb21-57"></a><span class="co">#&gt;  8 0.000632  ***         </span></span>
<span id="cb21-58"><a href="#cb21-58"></a><span class="co">#&gt;  9 0.390     ns          </span></span>
<span id="cb21-59"><a href="#cb21-59"></a><span class="co">#&gt; 10 0.0000502 ***         </span></span>
<span id="cb21-60"><a href="#cb21-60"></a><span class="co">#&gt; # ... with 14 more rows</span></span>
<span id="cb21-61"><a href="#cb21-61"></a></span>
<span id="cb21-62"><a href="#cb21-62"></a><span class="co"># getting tidy output of results</span></span>
<span id="cb21-63"><a href="#cb21-63"></a>groupedstats<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/groupedstats//reference/grouped_lmer.html">grouped_lmer</a></span>(</span>
<span id="cb21-64"><a href="#cb21-64"></a>  <span class="dt">data =</span> gapminder,</span>
<span id="cb21-65"><a href="#cb21-65"></a>  <span class="dt">formula =</span> <span class="kw"><a href="https://rdrr.io/r/base/scale.html">scale</a></span>(lifeExp) <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/scale.html">scale</a></span>(gdpPercap) <span class="op">+</span><span class="st"> </span>(gdpPercap <span class="op">|</span><span class="st"> </span>continent),</span>
<span id="cb21-66"><a href="#cb21-66"></a>  <span class="dt">grouping.vars =</span> year,</span>
<span id="cb21-67"><a href="#cb21-67"></a>  <span class="dt">REML =</span> <span class="ot">FALSE</span>,</span>
<span id="cb21-68"><a href="#cb21-68"></a>  <span class="dt">output =</span> <span class="st">"glance"</span></span>
<span id="cb21-69"><a href="#cb21-69"></a>)</span>
<span id="cb21-70"><a href="#cb21-70"></a><span class="co">#&gt; boundary (singular) fit: see ?isSingular</span></span>
<span id="cb21-71"><a href="#cb21-71"></a><span class="co">#&gt; boundary (singular) fit: see ?isSingular</span></span>
<span id="cb21-72"><a href="#cb21-72"></a><span class="co">#&gt; boundary (singular) fit: see ?isSingular</span></span>
<span id="cb21-73"><a href="#cb21-73"></a><span class="co">#&gt; boundary (singular) fit: see ?isSingular</span></span>
<span id="cb21-74"><a href="#cb21-74"></a><span class="co">#&gt; boundary (singular) fit: see ?isSingular</span></span>
<span id="cb21-75"><a href="#cb21-75"></a><span class="co">#&gt; boundary (singular) fit: see ?isSingular</span></span>
<span id="cb21-76"><a href="#cb21-76"></a><span class="co">#&gt; boundary (singular) fit: see ?isSingular</span></span>
<span id="cb21-77"><a href="#cb21-77"></a><span class="co">#&gt; boundary (singular) fit: see ?isSingular</span></span>
<span id="cb21-78"><a href="#cb21-78"></a><span class="co">#&gt; boundary (singular) fit: see ?isSingular</span></span>
<span id="cb21-79"><a href="#cb21-79"></a><span class="co">#&gt; boundary (singular) fit: see ?isSingular</span></span>
<span id="cb21-80"><a href="#cb21-80"></a><span class="co">#&gt; boundary (singular) fit: see ?isSingular</span></span>
<span id="cb21-81"><a href="#cb21-81"></a><span class="co">#&gt; # A tibble: 12 x 7</span></span>
<span id="cb21-82"><a href="#cb21-82"></a><span class="co">#&gt;     year sigma logLik   AIC   BIC deviance df.residual</span></span>
<span id="cb21-83"><a href="#cb21-83"></a><span class="co">#&gt;    &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt;</span></span>
<span id="cb21-84"><a href="#cb21-84"></a><span class="co">#&gt;  1  1952 0.524  -127.  266.  283.     254.         136</span></span>
<span id="cb21-85"><a href="#cb21-85"></a><span class="co">#&gt;  2  1957 0.557  -129.  270.  287.     258.         136</span></span>
<span id="cb21-86"><a href="#cb21-86"></a><span class="co">#&gt;  3  1962 0.545  -129.  271.  288.     259.         136</span></span>
<span id="cb21-87"><a href="#cb21-87"></a><span class="co">#&gt;  4  1967 0.565  -129.  270.  288.     258.         136</span></span>
<span id="cb21-88"><a href="#cb21-88"></a><span class="co">#&gt;  5  1972 0.583  -133.  278.  296.     266.         136</span></span>
<span id="cb21-89"><a href="#cb21-89"></a><span class="co">#&gt;  6  1977 0.579  -133.  277.  295.     265.         136</span></span>
<span id="cb21-90"><a href="#cb21-90"></a><span class="co">#&gt;  7  1982 0.535  -122.  255.  273.     243.         136</span></span>
<span id="cb21-91"><a href="#cb21-91"></a><span class="co">#&gt;  8  1987 0.496  -111.  233.  251.     221.         136</span></span>
<span id="cb21-92"><a href="#cb21-92"></a><span class="co">#&gt;  9  1992 0.526  -117.  246.  264.     234.         136</span></span>
<span id="cb21-93"><a href="#cb21-93"></a><span class="co">#&gt; 10  1997 0.494  -110.  232.  250.     220.         136</span></span>
<span id="cb21-94"><a href="#cb21-94"></a><span class="co">#&gt; 11  2002 0.506  -113.  239.  257.     227.         136</span></span>
<span id="cb21-95"><a href="#cb21-95"></a><span class="co">#&gt; 12  2007 0.520  -117.  247.  265.     235.         136</span></span></code></pre></div>
</div>
<div id="grouped_glmer" class="section level2">
<h2 class="hasAnchor">
<a href="#grouped_glmer" class="anchor"></a><code>grouped_glmer</code>
</h2>
<p>A more generalized version of <code>lmer</code> is implemented in <code><a href="https://rdrr.io/pkg/lme4/man/glmer.html">lme4::glmer</a></code>, which can also handle categorical/nominal data. For example, let’s say we want to see if sex of a person was predictive of whether they survived the Titanic tragedy.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="co"># for reproducibility</span></span>
<span id="cb22-2"><a href="#cb22-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb22-3"><a href="#cb22-3"></a></span>
<span id="cb22-4"><a href="#cb22-4"></a><span class="co"># having a look at the data</span></span>
<span id="cb22-5"><a href="#cb22-5"></a>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/reexports.html">glimpse</a></span>(groupedstats<span class="op">::</span>Titanic_full)</span>
<span id="cb22-6"><a href="#cb22-6"></a><span class="co">#&gt; Observations: 2,201</span></span>
<span id="cb22-7"><a href="#cb22-7"></a><span class="co">#&gt; Variables: 5</span></span>
<span id="cb22-8"><a href="#cb22-8"></a><span class="co">#&gt; $ id       &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,...</span></span>
<span id="cb22-9"><a href="#cb22-9"></a><span class="co">#&gt; $ Class    &lt;fct&gt; 3rd, 3rd, 3rd, 3rd, 3rd, 3rd, 3rd, 3rd, 3rd, 3rd, 3rd, 3rd...</span></span>
<span id="cb22-10"><a href="#cb22-10"></a><span class="co">#&gt; $ Sex      &lt;fct&gt; Male, Male, Male, Male, Male, Male, Male, Male, Male, Male...</span></span>
<span id="cb22-11"><a href="#cb22-11"></a><span class="co">#&gt; $ Age      &lt;fct&gt; Child, Child, Child, Child, Child, Child, Child, Child, Ch...</span></span>
<span id="cb22-12"><a href="#cb22-12"></a><span class="co">#&gt; $ Survived &lt;fct&gt; No, No, No, No, No, No, No, No, No, No, No, No, No, No, No...</span></span>
<span id="cb22-13"><a href="#cb22-13"></a></span>
<span id="cb22-14"><a href="#cb22-14"></a><span class="co"># running glmer model to get tidy output</span></span>
<span id="cb22-15"><a href="#cb22-15"></a>groupedstats<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/groupedstats//reference/grouped_glmer.html">grouped_glmer</a></span>(</span>
<span id="cb22-16"><a href="#cb22-16"></a>  <span class="dt">formula =</span> Survived <span class="op">~</span><span class="st"> </span>Age <span class="op">+</span><span class="st"> </span>(Age <span class="op">|</span><span class="st"> </span>Class),</span>
<span id="cb22-17"><a href="#cb22-17"></a>  <span class="dt">data =</span> groupedstats<span class="op">::</span>Titanic_full,</span>
<span id="cb22-18"><a href="#cb22-18"></a>  <span class="dt">family =</span> stats<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span>(<span class="dt">link =</span> <span class="st">"probit"</span>), <span class="co"># choosing the appropriate GLM family</span></span>
<span id="cb22-19"><a href="#cb22-19"></a>  <span class="dt">control =</span> lme4<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/lme4/man/lmerControl.html">glmerControl</a></span>( <span class="co"># choosing appropriate control</span></span>
<span id="cb22-20"><a href="#cb22-20"></a>    <span class="dt">optimizer =</span> <span class="st">"Nelder_Mead"</span>,</span>
<span id="cb22-21"><a href="#cb22-21"></a>    <span class="dt">boundary.tol =</span> <span class="fl">1e-07</span>,</span>
<span id="cb22-22"><a href="#cb22-22"></a>    <span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>,</span>
<span id="cb22-23"><a href="#cb22-23"></a>    <span class="dt">optCtrl =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">maxfun =</span> <span class="fl">2e9</span>)</span>
<span id="cb22-24"><a href="#cb22-24"></a>  ),</span>
<span id="cb22-25"><a href="#cb22-25"></a>  <span class="dt">grouping.vars =</span> Sex, <span class="co"># grouping variables (just one in this case)</span></span>
<span id="cb22-26"><a href="#cb22-26"></a>  <span class="dt">output =</span> <span class="st">"tidy"</span>,</span>
<span id="cb22-27"><a href="#cb22-27"></a>  <span class="dt">tidy.args =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">conf.int =</span> <span class="ot">TRUE</span>, <span class="dt">effects =</span> <span class="st">"fixed"</span>)</span>
<span id="cb22-28"><a href="#cb22-28"></a>)</span>
<span id="cb22-29"><a href="#cb22-29"></a><span class="co">#&gt; # A tibble: 4 x 10</span></span>
<span id="cb22-30"><a href="#cb22-30"></a><span class="co">#&gt;   Sex    effect term        estimate std.error statistic      p.value conf.low</span></span>
<span id="cb22-31"><a href="#cb22-31"></a><span class="co">#&gt;   &lt;fct&gt;  &lt;chr&gt;  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;        &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span id="cb22-32"><a href="#cb22-32"></a><span class="co">#&gt; 1 Female fixed  (Intercept)    1.01      0.379      2.66 0.00789         0.264</span></span>
<span id="cb22-33"><a href="#cb22-33"></a><span class="co">#&gt; 2 Female fixed  AgeChild       1.47      0.595      2.48 0.0133          0.307</span></span>
<span id="cb22-34"><a href="#cb22-34"></a><span class="co">#&gt; 3 Male   fixed  (Intercept)   -0.888     0.162     -5.47 0.0000000453   -1.21 </span></span>
<span id="cb22-35"><a href="#cb22-35"></a><span class="co">#&gt; 4 Male   fixed  AgeChild       4.90      4.03       1.22 0.224          -3.00 </span></span>
<span id="cb22-36"><a href="#cb22-36"></a><span class="co">#&gt;   conf.high significance</span></span>
<span id="cb22-37"><a href="#cb22-37"></a><span class="co">#&gt;       &lt;dbl&gt; &lt;chr&gt;       </span></span>
<span id="cb22-38"><a href="#cb22-38"></a><span class="co">#&gt; 1     1.75  **          </span></span>
<span id="cb22-39"><a href="#cb22-39"></a><span class="co">#&gt; 2     2.64  *           </span></span>
<span id="cb22-40"><a href="#cb22-40"></a><span class="co">#&gt; 3    -0.570 ***         </span></span>
<span id="cb22-41"><a href="#cb22-41"></a><span class="co">#&gt; 4    12.8   ns</span></span>
<span id="cb22-42"><a href="#cb22-42"></a></span>
<span id="cb22-43"><a href="#cb22-43"></a><span class="co"># getting glmer model summaries (let's use the default family and control values)</span></span>
<span id="cb22-44"><a href="#cb22-44"></a>groupedstats<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/groupedstats//reference/grouped_glmer.html">grouped_glmer</a></span>(</span>
<span id="cb22-45"><a href="#cb22-45"></a>  <span class="dt">data =</span> groupedstats<span class="op">::</span>Titanic_full,</span>
<span id="cb22-46"><a href="#cb22-46"></a>  <span class="dt">grouping.vars =</span> Sex,</span>
<span id="cb22-47"><a href="#cb22-47"></a>  <span class="dt">formula =</span> Survived <span class="op">~</span><span class="st"> </span>Age <span class="op">+</span><span class="st"> </span>(Age <span class="op">|</span><span class="st"> </span>Class),</span>
<span id="cb22-48"><a href="#cb22-48"></a>  <span class="dt">family =</span> stats<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span>(<span class="dt">link =</span> <span class="st">"probit"</span>),</span>
<span id="cb22-49"><a href="#cb22-49"></a>  <span class="dt">output =</span> <span class="st">"glance"</span></span>
<span id="cb22-50"><a href="#cb22-50"></a>)</span>
<span id="cb22-51"><a href="#cb22-51"></a><span class="co">#&gt; boundary (singular) fit: see ?isSingular</span></span>
<span id="cb22-52"><a href="#cb22-52"></a><span class="co">#&gt; # A tibble: 2 x 7</span></span>
<span id="cb22-53"><a href="#cb22-53"></a><span class="co">#&gt;   Sex    sigma logLik   AIC   BIC deviance df.residual</span></span>
<span id="cb22-54"><a href="#cb22-54"></a><span class="co">#&gt;   &lt;fct&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt;</span></span>
<span id="cb22-55"><a href="#cb22-55"></a><span class="co">#&gt; 1 Female     1  -208.  426.  447.     400.         465</span></span>
<span id="cb22-56"><a href="#cb22-56"></a><span class="co">#&gt; 2 Male       1  -860. 1730. 1757.    1698.        1726</span></span></code></pre></div>
<p>Note that the <code>statistic</code> will either be a <code>t</code> (gaussian, e.g.) or a <code>z</code> (binomial, e.g.) value, based on the family of models used.</p>
</div>
<div id="grouped_proptest" class="section level2">
<h2 class="hasAnchor">
<a href="#grouped_proptest" class="anchor"></a><code>grouped_proptest</code>
</h2>
<p>This function helps carry out one-sample proportion tests (<code><a href="https://rdrr.io/r/stats/chisq.test.html">stats::chisq.test</a></code>) with a unique variable for multiple grouping variables-</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="co"># for reproducibility</span></span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb23-3"><a href="#cb23-3"></a><span class="kw"><a href="https://rdrr.io/r/base/options.html">options</a></span>(<span class="dt">tibble.width =</span> <span class="ot">Inf</span>) <span class="co"># show me all columns</span></span>
<span id="cb23-4"><a href="#cb23-4"></a></span>
<span id="cb23-5"><a href="#cb23-5"></a>groupedstats<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/groupedstats//reference/grouped_proptest.html">grouped_proptest</a></span>(</span>
<span id="cb23-6"><a href="#cb23-6"></a>  <span class="dt">data =</span> mtcars,</span>
<span id="cb23-7"><a href="#cb23-7"></a>  <span class="dt">grouping.vars =</span> cyl,</span>
<span id="cb23-8"><a href="#cb23-8"></a>  <span class="dt">measure =</span> am</span>
<span id="cb23-9"><a href="#cb23-9"></a>)</span>
<span id="cb23-10"><a href="#cb23-10"></a><span class="co">#&gt; # A tibble: 3 x 8</span></span>
<span id="cb23-11"><a href="#cb23-11"></a><span class="co">#&gt;     cyl `0`    `1`    statistic p.value parameter</span></span>
<span id="cb23-12"><a href="#cb23-12"></a><span class="co">#&gt;   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb23-13"><a href="#cb23-13"></a><span class="co">#&gt; 1     4 27.27% 72.73%     2.27  0.132           1</span></span>
<span id="cb23-14"><a href="#cb23-14"></a><span class="co">#&gt; 2     6 57.14% 42.86%     0.143 0.705           1</span></span>
<span id="cb23-15"><a href="#cb23-15"></a><span class="co">#&gt; 3     8 85.71% 14.29%     7.14  0.00753         1</span></span>
<span id="cb23-16"><a href="#cb23-16"></a><span class="co">#&gt;   method                                   significance</span></span>
<span id="cb23-17"><a href="#cb23-17"></a><span class="co">#&gt;   &lt;chr&gt;                                    &lt;chr&gt;       </span></span>
<span id="cb23-18"><a href="#cb23-18"></a><span class="co">#&gt; 1 Chi-squared test for given probabilities ns          </span></span>
<span id="cb23-19"><a href="#cb23-19"></a><span class="co">#&gt; 2 Chi-squared test for given probabilities ns          </span></span>
<span id="cb23-20"><a href="#cb23-20"></a><span class="co">#&gt; 3 Chi-squared test for given probabilities **</span></span></code></pre></div>
</div>
<div id="grouped_ttest" class="section level2">
<h2 class="hasAnchor">
<a href="#grouped_ttest" class="anchor"></a><code>grouped_ttest</code>
</h2>
<p>This function can help you carry out t-tests, paired or independent, on multiple variables across multiple groups. Demonstrating how to use this function is going to first require getting the <code>iris</code> dataset into long format. Let’s say we want to investigate if <code>Sepal</code> part of the flower has greater measurement (length or width) than <code>Petal</code> part of the flower for <strong>each</strong> <em>Iris</em> species.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="co"># for reproducibility</span></span>
<span id="cb24-2"><a href="#cb24-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb24-3"><a href="#cb24-3"></a></span>
<span id="cb24-4"><a href="#cb24-4"></a><span class="co"># converting the iris dataset to long format</span></span>
<span id="cb24-5"><a href="#cb24-5"></a>iris_long &lt;-<span class="st"> </span>iris <span class="op">%&gt;%</span></span>
<span id="cb24-6"><a href="#cb24-6"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">.data =</span> ., <span class="dt">id =</span> dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/ranking.html">row_number</a></span>(<span class="dt">x =</span> Species)) <span class="op">%&gt;%</span></span>
<span id="cb24-7"><a href="#cb24-7"></a><span class="st">  </span>tidyr<span class="op">::</span><span class="kw"><a href="https://tidyr.tidyverse.org/reference/gather.html">gather</a></span>(</span>
<span id="cb24-8"><a href="#cb24-8"></a>    <span class="dt">data =</span> .,</span>
<span id="cb24-9"><a href="#cb24-9"></a>    <span class="dt">key =</span> <span class="st">"condition"</span>,</span>
<span id="cb24-10"><a href="#cb24-10"></a>    <span class="dt">value =</span> <span class="st">"value"</span>,</span>
<span id="cb24-11"><a href="#cb24-11"></a>    Sepal.Length<span class="op">:</span>Petal.Width,</span>
<span id="cb24-12"><a href="#cb24-12"></a>    <span class="dt">convert =</span> <span class="ot">TRUE</span>,</span>
<span id="cb24-13"><a href="#cb24-13"></a>    <span class="dt">factor_key =</span> <span class="ot">TRUE</span></span>
<span id="cb24-14"><a href="#cb24-14"></a>  ) <span class="op">%&gt;%</span></span>
<span id="cb24-15"><a href="#cb24-15"></a><span class="st">  </span>tidyr<span class="op">::</span><span class="kw"><a href="https://tidyr.tidyverse.org/reference/separate.html">separate</a></span>(</span>
<span id="cb24-16"><a href="#cb24-16"></a>    <span class="dt">col =</span> <span class="st">"condition"</span>,</span>
<span id="cb24-17"><a href="#cb24-17"></a>    <span class="dt">into =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"part"</span>, <span class="st">"measure"</span>),</span>
<span id="cb24-18"><a href="#cb24-18"></a>    <span class="dt">sep =</span> <span class="st">"</span><span class="ch">\\</span><span class="st">."</span>,</span>
<span id="cb24-19"><a href="#cb24-19"></a>    <span class="dt">convert =</span> <span class="ot">TRUE</span></span>
<span id="cb24-20"><a href="#cb24-20"></a>  ) <span class="op">%&gt;%</span></span>
<span id="cb24-21"><a href="#cb24-21"></a><span class="st">  </span>tibble<span class="op">::</span><span class="kw"><a href="https://tibble.tidyverse.org/reference/deprecated.html">as_data_frame</a></span>(<span class="dt">x =</span> .)</span>
<span id="cb24-22"><a href="#cb24-22"></a></span>
<span id="cb24-23"><a href="#cb24-23"></a><span class="co"># check the long format iris dataset</span></span>
<span id="cb24-24"><a href="#cb24-24"></a>iris_long</span>
<span id="cb24-25"><a href="#cb24-25"></a><span class="co">#&gt; # A tibble: 600 x 5</span></span>
<span id="cb24-26"><a href="#cb24-26"></a><span class="co">#&gt;    Species    id part  measure value</span></span>
<span id="cb24-27"><a href="#cb24-27"></a><span class="co">#&gt;    &lt;fct&gt;   &lt;int&gt; &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt;</span></span>
<span id="cb24-28"><a href="#cb24-28"></a><span class="co">#&gt;  1 setosa      1 Sepal Length    5.1</span></span>
<span id="cb24-29"><a href="#cb24-29"></a><span class="co">#&gt;  2 setosa      2 Sepal Length    4.9</span></span>
<span id="cb24-30"><a href="#cb24-30"></a><span class="co">#&gt;  3 setosa      3 Sepal Length    4.7</span></span>
<span id="cb24-31"><a href="#cb24-31"></a><span class="co">#&gt;  4 setosa      4 Sepal Length    4.6</span></span>
<span id="cb24-32"><a href="#cb24-32"></a><span class="co">#&gt;  5 setosa      5 Sepal Length    5  </span></span>
<span id="cb24-33"><a href="#cb24-33"></a><span class="co">#&gt;  6 setosa      6 Sepal Length    5.4</span></span>
<span id="cb24-34"><a href="#cb24-34"></a><span class="co">#&gt;  7 setosa      7 Sepal Length    4.6</span></span>
<span id="cb24-35"><a href="#cb24-35"></a><span class="co">#&gt;  8 setosa      8 Sepal Length    5  </span></span>
<span id="cb24-36"><a href="#cb24-36"></a><span class="co">#&gt;  9 setosa      9 Sepal Length    4.4</span></span>
<span id="cb24-37"><a href="#cb24-37"></a><span class="co">#&gt; 10 setosa     10 Sepal Length    4.9</span></span>
<span id="cb24-38"><a href="#cb24-38"></a><span class="co">#&gt; # ... with 590 more rows</span></span>
<span id="cb24-39"><a href="#cb24-39"></a></span>
<span id="cb24-40"><a href="#cb24-40"></a><span class="co"># checking if the Sepal part has different dimentions (value) than Petal part</span></span>
<span id="cb24-41"><a href="#cb24-41"></a><span class="co"># for each Species and for each type of measurement (Length and Width)</span></span>
<span id="cb24-42"><a href="#cb24-42"></a><span class="kw"><a href="https://rdrr.io/r/base/options.html">options</a></span>(<span class="dt">tibble.width =</span> <span class="ot">Inf</span>) <span class="co"># show me all columns</span></span>
<span id="cb24-43"><a href="#cb24-43"></a></span>
<span id="cb24-44"><a href="#cb24-44"></a>groupedstats<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/groupedstats//reference/grouped_ttest.html">grouped_ttest</a></span>(</span>
<span id="cb24-45"><a href="#cb24-45"></a>  <span class="dt">data =</span> iris_long,</span>
<span id="cb24-46"><a href="#cb24-46"></a>  <span class="dt">dep.vars =</span> value, <span class="co"># dependent variable</span></span>
<span id="cb24-47"><a href="#cb24-47"></a>  <span class="dt">indep.vars =</span> part, <span class="co"># independent variable</span></span>
<span id="cb24-48"><a href="#cb24-48"></a>  <span class="dt">grouping.vars =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(Species, measure), <span class="co"># for each Species and for each measurement</span></span>
<span id="cb24-49"><a href="#cb24-49"></a>  <span class="dt">paired =</span> <span class="ot">TRUE</span> <span class="co"># paired t-test</span></span>
<span id="cb24-50"><a href="#cb24-50"></a>)</span>
<span id="cb24-51"><a href="#cb24-51"></a><span class="co">#&gt; # A tibble: 6 x 11</span></span>
<span id="cb24-52"><a href="#cb24-52"></a><span class="co">#&gt;   Species    measure formula      method        t.test estimate conf.low</span></span>
<span id="cb24-53"><a href="#cb24-53"></a><span class="co">#&gt;   &lt;fct&gt;      &lt;chr&gt;   &lt;chr&gt;        &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span id="cb24-54"><a href="#cb24-54"></a><span class="co">#&gt; 1 setosa     Length  value ~ part Paired t-test  -71.8   -3.54     -3.64</span></span>
<span id="cb24-55"><a href="#cb24-55"></a><span class="co">#&gt; 2 versicolor Length  value ~ part Paired t-test  -34.0   -1.68     -1.78</span></span>
<span id="cb24-56"><a href="#cb24-56"></a><span class="co">#&gt; 3 virginica  Length  value ~ part Paired t-test  -22.9   -1.04     -1.13</span></span>
<span id="cb24-57"><a href="#cb24-57"></a><span class="co">#&gt; 4 setosa     Width   value ~ part Paired t-test  -61.0   -3.18     -3.29</span></span>
<span id="cb24-58"><a href="#cb24-58"></a><span class="co">#&gt; 5 versicolor Width   value ~ part Paired t-test  -43.5   -1.44     -1.51</span></span>
<span id="cb24-59"><a href="#cb24-59"></a><span class="co">#&gt; 6 virginica  Width   value ~ part Paired t-test  -23.1   -0.948    -1.03</span></span>
<span id="cb24-60"><a href="#cb24-60"></a><span class="co">#&gt;   conf.high parameter  p.value significance</span></span>
<span id="cb24-61"><a href="#cb24-61"></a><span class="co">#&gt;       &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;       </span></span>
<span id="cb24-62"><a href="#cb24-62"></a><span class="co">#&gt; 1    -3.44         49 2.54e-51 ***         </span></span>
<span id="cb24-63"><a href="#cb24-63"></a><span class="co">#&gt; 2    -1.58         49 9.67e-36 ***         </span></span>
<span id="cb24-64"><a href="#cb24-64"></a><span class="co">#&gt; 3    -0.945        49 7.99e-28 ***         </span></span>
<span id="cb24-65"><a href="#cb24-65"></a><span class="co">#&gt; 4    -3.08         49 7.21e-48 ***         </span></span>
<span id="cb24-66"><a href="#cb24-66"></a><span class="co">#&gt; 5    -1.38         49 8.42e-41 ***         </span></span>
<span id="cb24-67"><a href="#cb24-67"></a><span class="co">#&gt; 6    -0.866        49 5.34e-28 ***</span></span></code></pre></div>
</div>
<div id="grouped_wilcox" class="section level2">
<h2 class="hasAnchor">
<a href="#grouped_wilcox" class="anchor"></a><code>grouped_wilcox</code>
</h2>
<p>This function is just a non-parametric variant of the <code>grouped_ttest</code>:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="co"># for reproducibility</span></span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb25-3"><a href="#cb25-3"></a><span class="kw"><a href="https://rdrr.io/r/base/options.html">options</a></span>(<span class="dt">tibble.width =</span> <span class="ot">Inf</span>) <span class="co"># show me all columns</span></span>
<span id="cb25-4"><a href="#cb25-4"></a></span>
<span id="cb25-5"><a href="#cb25-5"></a>groupedstats<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/groupedstats//reference/grouped_wilcox.html">grouped_wilcox</a></span>(</span>
<span id="cb25-6"><a href="#cb25-6"></a>  <span class="dt">data =</span> iris_long,</span>
<span id="cb25-7"><a href="#cb25-7"></a>  <span class="dt">dep.vars =</span> value, <span class="co"># dependent variable</span></span>
<span id="cb25-8"><a href="#cb25-8"></a>  <span class="dt">indep.vars =</span> part, <span class="co"># independent variable</span></span>
<span id="cb25-9"><a href="#cb25-9"></a>  <span class="dt">grouping.vars =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(Species, measure), <span class="co"># for each Species and for each measurement</span></span>
<span id="cb25-10"><a href="#cb25-10"></a>  <span class="dt">paired =</span> <span class="ot">TRUE</span> <span class="co"># paired Wilcoxon signed rank test with continuity correction</span></span>
<span id="cb25-11"><a href="#cb25-11"></a>)</span>
<span id="cb25-12"><a href="#cb25-12"></a><span class="co">#&gt; # A tibble: 6 x 10</span></span>
<span id="cb25-13"><a href="#cb25-13"></a><span class="co">#&gt;   Species    measure formula     </span></span>
<span id="cb25-14"><a href="#cb25-14"></a><span class="co">#&gt;   &lt;fct&gt;      &lt;chr&gt;   &lt;chr&gt;       </span></span>
<span id="cb25-15"><a href="#cb25-15"></a><span class="co">#&gt; 1 setosa     Length  value ~ part</span></span>
<span id="cb25-16"><a href="#cb25-16"></a><span class="co">#&gt; 2 versicolor Length  value ~ part</span></span>
<span id="cb25-17"><a href="#cb25-17"></a><span class="co">#&gt; 3 virginica  Length  value ~ part</span></span>
<span id="cb25-18"><a href="#cb25-18"></a><span class="co">#&gt; 4 setosa     Width   value ~ part</span></span>
<span id="cb25-19"><a href="#cb25-19"></a><span class="co">#&gt; 5 versicolor Width   value ~ part</span></span>
<span id="cb25-20"><a href="#cb25-20"></a><span class="co">#&gt; 6 virginica  Width   value ~ part</span></span>
<span id="cb25-21"><a href="#cb25-21"></a><span class="co">#&gt;   method                                               statistic estimate</span></span>
<span id="cb25-22"><a href="#cb25-22"></a><span class="co">#&gt;   &lt;chr&gt;                                                    &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span id="cb25-23"><a href="#cb25-23"></a><span class="co">#&gt; 1 Wilcoxon signed rank test with continuity correction         0   -3.55 </span></span>
<span id="cb25-24"><a href="#cb25-24"></a><span class="co">#&gt; 2 Wilcoxon signed rank test with continuity correction         0   -1.70 </span></span>
<span id="cb25-25"><a href="#cb25-25"></a><span class="co">#&gt; 3 Wilcoxon signed rank test with continuity correction         0   -1.05 </span></span>
<span id="cb25-26"><a href="#cb25-26"></a><span class="co">#&gt; 4 Wilcoxon signed rank test with continuity correction         0   -3.15 </span></span>
<span id="cb25-27"><a href="#cb25-27"></a><span class="co">#&gt; 5 Wilcoxon signed rank test with continuity correction         0   -1.45 </span></span>
<span id="cb25-28"><a href="#cb25-28"></a><span class="co">#&gt; 6 Wilcoxon signed rank test with continuity correction         0   -0.950</span></span>
<span id="cb25-29"><a href="#cb25-29"></a><span class="co">#&gt;   conf.low conf.high  p.value significance</span></span>
<span id="cb25-30"><a href="#cb25-30"></a><span class="co">#&gt;      &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;       </span></span>
<span id="cb25-31"><a href="#cb25-31"></a><span class="co">#&gt; 1    -3.65    -3.45  7.62e-10 ***         </span></span>
<span id="cb25-32"><a href="#cb25-32"></a><span class="co">#&gt; 2    -1.80    -1.60  7.45e-10 ***         </span></span>
<span id="cb25-33"><a href="#cb25-33"></a><span class="co">#&gt; 3    -1.15    -0.950 7.48e-10 ***         </span></span>
<span id="cb25-34"><a href="#cb25-34"></a><span class="co">#&gt; 4    -3.25    -3.10  7.40e-10 ***         </span></span>
<span id="cb25-35"><a href="#cb25-35"></a><span class="co">#&gt; 5    -1.55    -1.40  7.58e-10 ***         </span></span>
<span id="cb25-36"><a href="#cb25-36"></a><span class="co">#&gt; 6    -1.00    -0.850 7.67e-10 ***</span></span></code></pre></div>
<p>While we are at it, let’s also check out examples for <code>t-test</code> and <code>Wilcox test</code> in case of between-subjects designs.</p>
<p>We will use <code>diamonds</code> dataset from <code>ggplot2</code> and will see if the price and depth of a diamond is different for two of our favorite colors (say <code>E</code> and <code>J</code>) for each type of clarity.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="co"># for reproducibility</span></span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb26-3"><a href="#cb26-3"></a></span>
<span id="cb26-4"><a href="#cb26-4"></a><span class="co"># subset the dataframe with two colors of interest to us</span></span>
<span id="cb26-5"><a href="#cb26-5"></a>diamonds_short &lt;-</span>
<span id="cb26-6"><a href="#cb26-6"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="dt">.data =</span> ggplot2<span class="op">::</span>diamonds, color <span class="op">==</span><span class="st"> "E"</span> <span class="op">|</span><span class="st"> </span>color <span class="op">==</span><span class="st"> "J"</span>)</span>
<span id="cb26-7"><a href="#cb26-7"></a></span>
<span id="cb26-8"><a href="#cb26-8"></a><span class="co"># show me all rows and columns</span></span>
<span id="cb26-9"><a href="#cb26-9"></a><span class="kw"><a href="https://rdrr.io/r/base/options.html">options</a></span>(<span class="dt">tibble.width =</span> <span class="ot">Inf</span>, <span class="dt">tibble.print_max =</span> <span class="ot">Inf</span>) </span>
<span id="cb26-10"><a href="#cb26-10"></a></span>
<span id="cb26-11"><a href="#cb26-11"></a><span class="co"># t-test</span></span>
<span id="cb26-12"><a href="#cb26-12"></a>groupedstats<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/groupedstats//reference/grouped_ttest.html">grouped_ttest</a></span>(</span>
<span id="cb26-13"><a href="#cb26-13"></a>  <span class="dt">data =</span> diamonds_short,</span>
<span id="cb26-14"><a href="#cb26-14"></a>  <span class="dt">dep.vars =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(carat, price, depth), <span class="co"># note that there three dependent variables</span></span>
<span id="cb26-15"><a href="#cb26-15"></a>  <span class="dt">indep.vars =</span> color, <span class="co"># and just one independent variable</span></span>
<span id="cb26-16"><a href="#cb26-16"></a>  <span class="dt">grouping.vars =</span> clarity, <span class="co"># one grouping variable</span></span>
<span id="cb26-17"><a href="#cb26-17"></a>  <span class="dt">paired =</span> <span class="ot">FALSE</span>,</span>
<span id="cb26-18"><a href="#cb26-18"></a>  <span class="dt">var.equal =</span> <span class="ot">FALSE</span></span>
<span id="cb26-19"><a href="#cb26-19"></a>)</span>
<span id="cb26-20"><a href="#cb26-20"></a><span class="co">#&gt; # A tibble: 24 x 10</span></span>
<span id="cb26-21"><a href="#cb26-21"></a><span class="co">#&gt;    clarity formula       method                   t.test   estimate  conf.low</span></span>
<span id="cb26-22"><a href="#cb26-22"></a><span class="co">#&gt;    &lt;ord&gt;   &lt;chr&gt;         &lt;chr&gt;                     &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb26-23"><a href="#cb26-23"></a><span class="co">#&gt;  1 SI2     carat ~ color Welch Two Sample t-test -18.0      -0.503     -0.558</span></span>
<span id="cb26-24"><a href="#cb26-24"></a><span class="co">#&gt;  2 SI1     carat ~ color Welch Two Sample t-test -22.1      -0.462     -0.503</span></span>
<span id="cb26-25"><a href="#cb26-25"></a><span class="co">#&gt;  3 VS1     carat ~ color Welch Two Sample t-test -16.8      -0.444     -0.496</span></span>
<span id="cb26-26"><a href="#cb26-26"></a><span class="co">#&gt;  4 VVS2    carat ~ color Welch Two Sample t-test -12.0      -0.553     -0.644</span></span>
<span id="cb26-27"><a href="#cb26-27"></a><span class="co">#&gt;  5 VS2     carat ~ color Welch Two Sample t-test -24.6      -0.542     -0.586</span></span>
<span id="cb26-28"><a href="#cb26-28"></a><span class="co">#&gt;  6 I1      carat ~ color Welch Two Sample t-test  -4.48     -0.644     -0.932</span></span>
<span id="cb26-29"><a href="#cb26-29"></a><span class="co">#&gt;  7 VVS1    carat ~ color Welch Two Sample t-test  -6.53     -0.417     -0.545</span></span>
<span id="cb26-30"><a href="#cb26-30"></a><span class="co">#&gt;  8 IF      carat ~ color Welch Two Sample t-test  -2.38     -0.198     -0.364</span></span>
<span id="cb26-31"><a href="#cb26-31"></a><span class="co">#&gt;  9 SI2     price ~ color Welch Two Sample t-test -10.6   -2347.     -2782.   </span></span>
<span id="cb26-32"><a href="#cb26-32"></a><span class="co">#&gt; 10 SI1     price ~ color Welch Two Sample t-test -12.6   -2024.     -2339.   </span></span>
<span id="cb26-33"><a href="#cb26-33"></a><span class="co">#&gt; 11 VS1     price ~ color Welch Two Sample t-test  -9.26  -2028.     -2458.   </span></span>
<span id="cb26-34"><a href="#cb26-34"></a><span class="co">#&gt; 12 VVS2    price ~ color Welch Two Sample t-test  -6.83  -2643.     -3407.   </span></span>
<span id="cb26-35"><a href="#cb26-35"></a><span class="co">#&gt; 13 VS2     price ~ color Welch Two Sample t-test -14.3   -2560.     -2911.   </span></span>
<span id="cb26-36"><a href="#cb26-36"></a><span class="co">#&gt; 14 I1      price ~ color Welch Two Sample t-test  -2.76  -1766.     -3044.   </span></span>
<span id="cb26-37"><a href="#cb26-37"></a><span class="co">#&gt; 15 VVS1    price ~ color Welch Two Sample t-test  -3.35  -1814.     -2893.   </span></span>
<span id="cb26-38"><a href="#cb26-38"></a><span class="co">#&gt; 16 IF      price ~ color Welch Two Sample t-test   0.378   305.     -1299.   </span></span>
<span id="cb26-39"><a href="#cb26-39"></a><span class="co">#&gt; 17 SI2     depth ~ color Welch Two Sample t-test  -2.64     -0.231     -0.402</span></span>
<span id="cb26-40"><a href="#cb26-40"></a><span class="co">#&gt; 18 SI1     depth ~ color Welch Two Sample t-test   0.333     0.0208    -0.102</span></span>
<span id="cb26-41"><a href="#cb26-41"></a><span class="co">#&gt; 19 VS1     depth ~ color Welch Two Sample t-test  -6.61     -0.417     -0.541</span></span>
<span id="cb26-42"><a href="#cb26-42"></a><span class="co">#&gt; 20 VVS2    depth ~ color Welch Two Sample t-test  -2.20     -0.277     -0.526</span></span>
<span id="cb26-43"><a href="#cb26-43"></a><span class="co">#&gt; 21 VS2     depth ~ color Welch Two Sample t-test  -2.28     -0.145     -0.271</span></span>
<span id="cb26-44"><a href="#cb26-44"></a><span class="co">#&gt; 22 I1      depth ~ color Welch Two Sample t-test  -3.96     -2.10      -3.16 </span></span>
<span id="cb26-45"><a href="#cb26-45"></a><span class="co">#&gt; 23 VVS1    depth ~ color Welch Two Sample t-test  -2.53     -0.370     -0.661</span></span>
<span id="cb26-46"><a href="#cb26-46"></a><span class="co">#&gt; 24 IF      depth ~ color Welch Two Sample t-test  -2.16     -0.386     -0.739</span></span>
<span id="cb26-47"><a href="#cb26-47"></a><span class="co">#&gt;     conf.high parameter   p.value significance</span></span>
<span id="cb26-48"><a href="#cb26-48"></a><span class="co">#&gt;         &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;       </span></span>
<span id="cb26-49"><a href="#cb26-49"></a><span class="co">#&gt;  1    -0.448      634.  9.24e- 59 ***         </span></span>
<span id="cb26-50"><a href="#cb26-50"></a><span class="co">#&gt;  2    -0.420      948.  2.47e- 87 ***         </span></span>
<span id="cb26-51"><a href="#cb26-51"></a><span class="co">#&gt;  3    -0.392      663.  2.91e- 53 ***         </span></span>
<span id="cb26-52"><a href="#cb26-52"></a><span class="co">#&gt;  4    -0.461      140.  3.81e- 23 ***         </span></span>
<span id="cb26-53"><a href="#cb26-53"></a><span class="co">#&gt;  5    -0.499      856.  1.51e-101 ***         </span></span>
<span id="cb26-54"><a href="#cb26-54"></a><span class="co">#&gt;  6    -0.357       60.6 3.34e-  5 ***         </span></span>
<span id="cb26-55"><a href="#cb26-55"></a><span class="co">#&gt;  7    -0.290       76.1 6.68e-  9 ***         </span></span>
<span id="cb26-56"><a href="#cb26-56"></a><span class="co">#&gt;  8    -0.0318      60.1 2.03e-  2 *           </span></span>
<span id="cb26-57"><a href="#cb26-57"></a><span class="co">#&gt;  9 -1913.         676.  2.02e- 24 ***         </span></span>
<span id="cb26-58"><a href="#cb26-58"></a><span class="co">#&gt; 10 -1709.        1031.  5.75e- 34 ***         </span></span>
<span id="cb26-59"><a href="#cb26-59"></a><span class="co">#&gt; 11 -1598.         794.  1.86e- 19 ***         </span></span>
<span id="cb26-60"><a href="#cb26-60"></a><span class="co">#&gt; 12 -1878.         151.  1.94e- 10 ***         </span></span>
<span id="cb26-61"><a href="#cb26-61"></a><span class="co">#&gt; 13 -2209.         943.  3.07e- 42 ***         </span></span>
<span id="cb26-62"><a href="#cb26-62"></a><span class="co">#&gt; 14  -487.          62.0 7.58e-  3 **          </span></span>
<span id="cb26-63"><a href="#cb26-63"></a><span class="co">#&gt; 15  -735.          81.2 1.24e-  3 **          </span></span>
<span id="cb26-64"><a href="#cb26-64"></a><span class="co">#&gt; 16  1909.          81.0 7.07e-  1 ns          </span></span>
<span id="cb26-65"><a href="#cb26-65"></a><span class="co">#&gt; 17    -0.0588     772.  8.58e-  3 **          </span></span>
<span id="cb26-66"><a href="#cb26-66"></a><span class="co">#&gt; 18     0.143     1245.  7.39e-  1 ns          </span></span>
<span id="cb26-67"><a href="#cb26-67"></a><span class="co">#&gt; 19    -0.293     1040.  6.08e- 11 ***         </span></span>
<span id="cb26-68"><a href="#cb26-68"></a><span class="co">#&gt; 20    -0.0279     158.  2.95e-  2 *           </span></span>
<span id="cb26-69"><a href="#cb26-69"></a><span class="co">#&gt; 21    -0.0203    1084.  2.28e-  2 *           </span></span>
<span id="cb26-70"><a href="#cb26-70"></a><span class="co">#&gt; 22    -1.05        81.6 1.61e-  4 ***         </span></span>
<span id="cb26-71"><a href="#cb26-71"></a><span class="co">#&gt; 23    -0.0792      88.1 1.32e-  2 *           </span></span>
<span id="cb26-72"><a href="#cb26-72"></a><span class="co">#&gt; 24    -0.0321     111.  3.28e-  2 *</span></span>
<span id="cb26-73"><a href="#cb26-73"></a></span>
<span id="cb26-74"><a href="#cb26-74"></a><span class="co"># wilcox test (aka Mann-Whitney U-test)</span></span>
<span id="cb26-75"><a href="#cb26-75"></a>groupedstats<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/groupedstats//reference/grouped_wilcox.html">grouped_wilcox</a></span>(</span>
<span id="cb26-76"><a href="#cb26-76"></a>  <span class="dt">data =</span> diamonds_short,</span>
<span id="cb26-77"><a href="#cb26-77"></a>  <span class="dt">dep.vars =</span> depth<span class="op">:</span>price, <span class="co"># note that you can select variables in range with `:`</span></span>
<span id="cb26-78"><a href="#cb26-78"></a>  <span class="dt">indep.vars =</span> color, <span class="co"># again, just one independent, multiple dependent variables case</span></span>
<span id="cb26-79"><a href="#cb26-79"></a>  <span class="dt">grouping.vars =</span> clarity, <span class="co"># one grouping variable</span></span>
<span id="cb26-80"><a href="#cb26-80"></a>  <span class="dt">paired =</span> <span class="ot">FALSE</span></span>
<span id="cb26-81"><a href="#cb26-81"></a>)</span>
<span id="cb26-82"><a href="#cb26-82"></a><span class="co">#&gt; # A tibble: 16 x 9</span></span>
<span id="cb26-83"><a href="#cb26-83"></a><span class="co">#&gt;    clarity formula       method                                           </span></span>
<span id="cb26-84"><a href="#cb26-84"></a><span class="co">#&gt;    &lt;ord&gt;   &lt;chr&gt;         &lt;chr&gt;                                            </span></span>
<span id="cb26-85"><a href="#cb26-85"></a><span class="co">#&gt;  1 SI2     depth ~ color Wilcoxon rank sum test with continuity correction</span></span>
<span id="cb26-86"><a href="#cb26-86"></a><span class="co">#&gt;  2 SI1     depth ~ color Wilcoxon rank sum test with continuity correction</span></span>
<span id="cb26-87"><a href="#cb26-87"></a><span class="co">#&gt;  3 VS1     depth ~ color Wilcoxon rank sum test with continuity correction</span></span>
<span id="cb26-88"><a href="#cb26-88"></a><span class="co">#&gt;  4 VVS2    depth ~ color Wilcoxon rank sum test with continuity correction</span></span>
<span id="cb26-89"><a href="#cb26-89"></a><span class="co">#&gt;  5 VS2     depth ~ color Wilcoxon rank sum test with continuity correction</span></span>
<span id="cb26-90"><a href="#cb26-90"></a><span class="co">#&gt;  6 I1      depth ~ color Wilcoxon rank sum test with continuity correction</span></span>
<span id="cb26-91"><a href="#cb26-91"></a><span class="co">#&gt;  7 VVS1    depth ~ color Wilcoxon rank sum test with continuity correction</span></span>
<span id="cb26-92"><a href="#cb26-92"></a><span class="co">#&gt;  8 IF      depth ~ color Wilcoxon rank sum test with continuity correction</span></span>
<span id="cb26-93"><a href="#cb26-93"></a><span class="co">#&gt;  9 SI2     price ~ color Wilcoxon rank sum test with continuity correction</span></span>
<span id="cb26-94"><a href="#cb26-94"></a><span class="co">#&gt; 10 SI1     price ~ color Wilcoxon rank sum test with continuity correction</span></span>
<span id="cb26-95"><a href="#cb26-95"></a><span class="co">#&gt; 11 VS1     price ~ color Wilcoxon rank sum test with continuity correction</span></span>
<span id="cb26-96"><a href="#cb26-96"></a><span class="co">#&gt; 12 VVS2    price ~ color Wilcoxon rank sum test with continuity correction</span></span>
<span id="cb26-97"><a href="#cb26-97"></a><span class="co">#&gt; 13 VS2     price ~ color Wilcoxon rank sum test with continuity correction</span></span>
<span id="cb26-98"><a href="#cb26-98"></a><span class="co">#&gt; 14 I1      price ~ color Wilcoxon rank sum test with continuity correction</span></span>
<span id="cb26-99"><a href="#cb26-99"></a><span class="co">#&gt; 15 VVS1    price ~ color Wilcoxon rank sum test with continuity correction</span></span>
<span id="cb26-100"><a href="#cb26-100"></a><span class="co">#&gt; 16 IF      price ~ color Wilcoxon rank sum test with continuity correction</span></span>
<span id="cb26-101"><a href="#cb26-101"></a><span class="co">#&gt;    statistic      estimate  conf.low     conf.high  p.value significance</span></span>
<span id="cb26-102"><a href="#cb26-102"></a><span class="co">#&gt;        &lt;dbl&gt;         &lt;dbl&gt;     &lt;dbl&gt;         &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;       </span></span>
<span id="cb26-103"><a href="#cb26-103"></a><span class="co">#&gt;  1   380600     -0.200        -0.300    -0.0000364 1.54e- 2 *           </span></span>
<span id="cb26-104"><a href="#cb26-104"></a><span class="co">#&gt;  2   918892      0.0000393    -0.100     0.100     6.77e- 1 ns          </span></span>
<span id="cb26-105"><a href="#cb26-105"></a><span class="co">#&gt;  3   276743     -0.400        -0.500    -0.300     7.03e-12 ***         </span></span>
<span id="cb26-106"><a href="#cb26-106"></a><span class="co">#&gt;  4    52618     -0.400        -0.600    -0.200     4.18e- 4 ***         </span></span>
<span id="cb26-107"><a href="#cb26-107"></a><span class="co">#&gt;  5   816784.    -0.200        -0.300    -0.100     8.86e- 5 ***         </span></span>
<span id="cb26-108"><a href="#cb26-108"></a><span class="co">#&gt;  6     1570.    -2.00         -3.00     -1.00      1.21e- 4 ***         </span></span>
<span id="cb26-109"><a href="#cb26-109"></a><span class="co">#&gt;  7    19455     -0.300        -0.500    -0.100     5.07e- 3 **          </span></span>
<span id="cb26-110"><a href="#cb26-110"></a><span class="co">#&gt;  8     3286     -0.300        -0.700    -0.0000251 4.79e- 2 *           </span></span>
<span id="cb26-111"><a href="#cb26-111"></a><span class="co">#&gt;  9   269016  -1844.        -2182.    -1505.        8.82e-31 ***         </span></span>
<span id="cb26-112"><a href="#cb26-112"></a><span class="co">#&gt; 10   608724. -1510.        -1789.    -1312.        8.20e-43 ***         </span></span>
<span id="cb26-113"><a href="#cb26-113"></a><span class="co">#&gt; 11   277389  -1095.        -1414.     -745.        1.11e-11 ***         </span></span>
<span id="cb26-114"><a href="#cb26-114"></a><span class="co">#&gt; 12    42795  -1764.        -2920.    -1205.        2.23e-10 ***         </span></span>
<span id="cb26-115"><a href="#cb26-115"></a><span class="co">#&gt; 13   560930  -1888.        -2228.    -1539.        1.08e-54 ***         </span></span>
<span id="cb26-116"><a href="#cb26-116"></a><span class="co">#&gt; 14     2017  -1150.        -1832.      -79.0       3.68e- 2 *           </span></span>
<span id="cb26-117"><a href="#cb26-117"></a><span class="co">#&gt; 15    19086   -362.         -859.     -107.        2.57e- 3 **          </span></span>
<span id="cb26-118"><a href="#cb26-118"></a><span class="co">#&gt; 16     5085    296.          125.      449.        4.94e- 3 **</span></span></code></pre></div>
<p>We can further focus just on two levels of clarity to further elucidate another aspect of entering the arguments-</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="co"># for reproducibility</span></span>
<span id="cb27-2"><a href="#cb27-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb27-3"><a href="#cb27-3"></a></span>
<span id="cb27-4"><a href="#cb27-4"></a><span class="co"># subset the dataframe even further to just select two levels of clarity</span></span>
<span id="cb27-5"><a href="#cb27-5"></a>diamonds_short2 &lt;-</span>
<span id="cb27-6"><a href="#cb27-6"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="dt">.data =</span> diamonds_short, clarity <span class="op">==</span><span class="st"> "SI2"</span> <span class="op">|</span><span class="st"> </span>clarity <span class="op">==</span><span class="st"> "SI1"</span>)</span>
<span id="cb27-7"><a href="#cb27-7"></a></span>
<span id="cb27-8"><a href="#cb27-8"></a><span class="co"># wilcox test (aka Mann-Whitney U-test)</span></span>
<span id="cb27-9"><a href="#cb27-9"></a>groupedstats<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/groupedstats//reference/grouped_wilcox.html">grouped_wilcox</a></span>(</span>
<span id="cb27-10"><a href="#cb27-10"></a>  <span class="dt">data =</span> diamonds_short2,</span>
<span id="cb27-11"><a href="#cb27-11"></a>  <span class="dt">dep.vars =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(carat, price), <span class="co"># two dependent variables</span></span>
<span id="cb27-12"><a href="#cb27-12"></a>  <span class="dt">indep.vars =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(color, clarity), <span class="co"># two independent variables</span></span>
<span id="cb27-13"><a href="#cb27-13"></a>  <span class="dt">grouping.vars =</span> cut, <span class="co"># one grouping variable</span></span>
<span id="cb27-14"><a href="#cb27-14"></a>  <span class="dt">paired =</span> <span class="ot">FALSE</span></span>
<span id="cb27-15"><a href="#cb27-15"></a>)</span>
<span id="cb27-16"><a href="#cb27-16"></a><span class="co">#&gt; # A tibble: 10 x 9</span></span>
<span id="cb27-17"><a href="#cb27-17"></a><span class="co">#&gt;    cut       formula         method                                           </span></span>
<span id="cb27-18"><a href="#cb27-18"></a><span class="co">#&gt;    &lt;ord&gt;     &lt;chr&gt;           &lt;chr&gt;                                            </span></span>
<span id="cb27-19"><a href="#cb27-19"></a><span class="co">#&gt;  1 Ideal     carat ~ color   Wilcoxon rank sum test with continuity correction</span></span>
<span id="cb27-20"><a href="#cb27-20"></a><span class="co">#&gt;  2 Premium   carat ~ color   Wilcoxon rank sum test with continuity correction</span></span>
<span id="cb27-21"><a href="#cb27-21"></a><span class="co">#&gt;  3 Good      carat ~ color   Wilcoxon rank sum test with continuity correction</span></span>
<span id="cb27-22"><a href="#cb27-22"></a><span class="co">#&gt;  4 Very Good carat ~ color   Wilcoxon rank sum test with continuity correction</span></span>
<span id="cb27-23"><a href="#cb27-23"></a><span class="co">#&gt;  5 Fair      carat ~ color   Wilcoxon rank sum test with continuity correction</span></span>
<span id="cb27-24"><a href="#cb27-24"></a><span class="co">#&gt;  6 Ideal     price ~ clarity Wilcoxon rank sum test with continuity correction</span></span>
<span id="cb27-25"><a href="#cb27-25"></a><span class="co">#&gt;  7 Premium   price ~ clarity Wilcoxon rank sum test with continuity correction</span></span>
<span id="cb27-26"><a href="#cb27-26"></a><span class="co">#&gt;  8 Good      price ~ clarity Wilcoxon rank sum test with continuity correction</span></span>
<span id="cb27-27"><a href="#cb27-27"></a><span class="co">#&gt;  9 Very Good price ~ clarity Wilcoxon rank sum test with continuity correction</span></span>
<span id="cb27-28"><a href="#cb27-28"></a><span class="co">#&gt; 10 Fair      price ~ clarity Wilcoxon rank sum test with continuity correction</span></span>
<span id="cb27-29"><a href="#cb27-29"></a><span class="co">#&gt;    statistic estimate conf.low conf.high  p.value significance</span></span>
<span id="cb27-30"><a href="#cb27-30"></a><span class="co">#&gt;        &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;       </span></span>
<span id="cb27-31"><a href="#cb27-31"></a><span class="co">#&gt;  1   103150.   -0.440   -0.500    -0.380 1.28e-51 ***         </span></span>
<span id="cb27-32"><a href="#cb27-32"></a><span class="co">#&gt;  2    91748    -0.540   -0.600    -0.490 1.82e-59 ***         </span></span>
<span id="cb27-33"><a href="#cb27-33"></a><span class="co">#&gt;  3    20752    -0.400   -0.500    -0.310 4.49e-18 ***         </span></span>
<span id="cb27-34"><a href="#cb27-34"></a><span class="co">#&gt;  4    87590    -0.390   -0.460    -0.320 7.06e-37 ***         </span></span>
<span id="cb27-35"><a href="#cb27-35"></a><span class="co">#&gt;  5     2356.   -0.230   -0.370    -0.110 1.21e- 5 ***         </span></span>
<span id="cb27-36"><a href="#cb27-36"></a><span class="co">#&gt;  6   344274.  774.     536.     1075.    3.00e- 9 ***         </span></span>
<span id="cb27-37"><a href="#cb27-37"></a><span class="co">#&gt;  7   329276.  876.     538.     1278.    3.52e- 9 ***         </span></span>
<span id="cb27-38"><a href="#cb27-38"></a><span class="co">#&gt;  8    64082.  516.     141.      921.    3.05e- 3 **          </span></span>
<span id="cb27-39"><a href="#cb27-39"></a><span class="co">#&gt;  9   272064   752.     486.     1098.    2.76e- 8 ***         </span></span>
<span id="cb27-40"><a href="#cb27-40"></a><span class="co">#&gt; 10     5113   170.    -411.      802.    5.68e- 1 ns</span></span></code></pre></div>
<p>In these examples, two things are worth noting that generalize to <strong>all</strong> functions in this package and stem from how tidy evaluation (<a href="https://adv-r.hadley.nz/evaluation.html" class="uri">https://adv-r.hadley.nz/evaluation.html</a>) works:</p>
<ul>
<li>If just one independent variable is provided for multiple dependent variables, it will be used as a common variable.</li>
<li>If you want to use a selection of variables, you need not use <code><a href="https://rdrr.io/r/base/c.html">c()</a></code>.</li>
</ul>
</div>
</div>
<div id="extending-with-purrr" class="section level1">
<h1 class="hasAnchor">
<a href="#extending-with-purrr" class="anchor"></a>Extending with <code>purrr</code>
</h1>
<p><code>groupedstats</code> functions can be further extended with <code>purrr</code> package. For example, let’s say we want to run the same linear regression across multiple grouping variables but want to use different formulas-</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="co"># for reproducibility</span></span>
<span id="cb28-2"><a href="#cb28-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb28-3"><a href="#cb28-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(groupedstats)</span>
<span id="cb28-4"><a href="#cb28-4"></a></span>
<span id="cb28-5"><a href="#cb28-5"></a>results_df &lt;-</span>
<span id="cb28-6"><a href="#cb28-6"></a><span class="st">  </span>purrr<span class="op">::</span><span class="kw"><a href="https://purrr.tidyverse.org/reference/map2.html">pmap_dfr</a></span>(</span>
<span id="cb28-7"><a href="#cb28-7"></a>    <span class="dt">.l =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(</span>
<span id="cb28-8"><a href="#cb28-8"></a>      <span class="dt">data =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(groupedstats<span class="op">::</span>movies_long),</span>
<span id="cb28-9"><a href="#cb28-9"></a>      <span class="dt">grouping.vars =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">alist</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(mpaa, genre)), <span class="co"># note it's `alist` and not `list`</span></span>
<span id="cb28-10"><a href="#cb28-10"></a>      <span class="dt">formula =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(</span>
<span id="cb28-11"><a href="#cb28-11"></a>        rating <span class="op">~</span><span class="st"> </span>budget, <span class="co"># model 1</span></span>
<span id="cb28-12"><a href="#cb28-12"></a>        rating <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(budget), <span class="co"># model 2</span></span>
<span id="cb28-13"><a href="#cb28-13"></a>        <span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(rating) <span class="op">~</span><span class="st"> </span>budget, <span class="co"># model 3</span></span>
<span id="cb28-14"><a href="#cb28-14"></a>        <span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(rating) <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(budget) <span class="co"># model 4</span></span>
<span id="cb28-15"><a href="#cb28-15"></a>      ),</span>
<span id="cb28-16"><a href="#cb28-16"></a>      <span class="dt">output =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"glance"</span>) <span class="co"># return model diagnostics</span></span>
<span id="cb28-17"><a href="#cb28-17"></a>    ),</span>
<span id="cb28-18"><a href="#cb28-18"></a>    <span class="dt">.f =</span> groupedstats<span class="op">::</span>grouped_lm, <span class="co"># regression model</span></span>
<span id="cb28-19"><a href="#cb28-19"></a>    <span class="dt">.id =</span> <span class="st">"model"</span></span>
<span id="cb28-20"><a href="#cb28-20"></a>  ) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># for each combination of mpaa rating and movie genre</span></span>
<span id="cb28-21"><a href="#cb28-21"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(<span class="dt">.data =</span> ., mpaa, genre) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># arrange by best to worst fits</span></span>
<span id="cb28-22"><a href="#cb28-22"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span>(<span class="dt">.data =</span> ., dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span>(adj.r.squared))</span>
<span id="cb28-23"><a href="#cb28-23"></a></span>
<span id="cb28-24"><a href="#cb28-24"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(results_df)</span>
<span id="cb28-25"><a href="#cb28-25"></a><span class="co">#&gt; # A tibble: 6 x 15</span></span>
<span id="cb28-26"><a href="#cb28-26"></a><span class="co">#&gt; # Groups:   mpaa, genre [3]</span></span>
<span id="cb28-27"><a href="#cb28-27"></a><span class="co">#&gt;   model mpaa  genre       r.squared adj.r.squared  sigma statistic      p.value</span></span>
<span id="cb28-28"><a href="#cb28-28"></a><span class="co">#&gt;   &lt;chr&gt; &lt;fct&gt; &lt;fct&gt;           &lt;dbl&gt;         &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb28-29"><a href="#cb28-29"></a><span class="co">#&gt; 1 2     PG-13 Animation       0.474         0.369 0.824       4.51 0.0870      </span></span>
<span id="cb28-30"><a href="#cb28-30"></a><span class="co">#&gt; 2 4     PG-13 Animation       0.447         0.337 0.138       4.05 0.100       </span></span>
<span id="cb28-31"><a href="#cb28-31"></a><span class="co">#&gt; 3 3     PG    Documentary     0.468         0.202 0.0532      1.76 0.316       </span></span>
<span id="cb28-32"><a href="#cb28-32"></a><span class="co">#&gt; 4 1     PG    Documentary     0.449         0.174 0.386       1.63 0.330       </span></span>
<span id="cb28-33"><a href="#cb28-33"></a><span class="co">#&gt; 5 4     R     Action          0.142         0.138 0.254      34.6  0.0000000162</span></span>
<span id="cb28-34"><a href="#cb28-34"></a><span class="co">#&gt; 6 2     R     Action          0.129         0.125 1.31       30.9  0.0000000825</span></span>
<span id="cb28-35"><a href="#cb28-35"></a><span class="co">#&gt;      df   logLik    AIC    BIC  deviance df.residual  nobs</span></span>
<span id="cb28-36"><a href="#cb28-36"></a><span class="co">#&gt;   &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb28-37"><a href="#cb28-37"></a><span class="co">#&gt; 1     1   -7.40   20.8   20.6    3.39              5     7</span></span>
<span id="cb28-38"><a href="#cb28-38"></a><span class="co">#&gt; 2     1    5.09   -4.18  -4.35   0.0957            5     7</span></span>
<span id="cb28-39"><a href="#cb28-39"></a><span class="co">#&gt; 3     1    7.45   -8.90 -10.7    0.00565           2     4</span></span>
<span id="cb28-40"><a href="#cb28-40"></a><span class="co">#&gt; 4     1   -0.479   6.96   5.12   0.298             2     4</span></span>
<span id="cb28-41"><a href="#cb28-41"></a><span class="co">#&gt; 5     1   -9.39   24.8   34.8   13.5             209   211</span></span>
<span id="cb28-42"><a href="#cb28-42"></a><span class="co">#&gt; 6     1 -356.    718.   728.   361.              209   211</span></span></code></pre></div>
</div>
<div id="current-code-coverage" class="section level1">
<h1 class="hasAnchor">
<a href="#current-code-coverage" class="anchor"></a>Current code coverage</h1>
<p>As the code stands right now, here is the code coverage for all primary functions involved: <a href="https://codecov.io/gh/IndrajeetPatil/groupedstats/tree/master/R" class="uri">https://codecov.io/gh/IndrajeetPatil/groupedstats/tree/master/R</a></p>
</div>
<div id="contributing" class="section level1">
<h1 class="hasAnchor">
<a href="#contributing" class="anchor"></a>Contributing</h1>
<p>I’m happy to receive bug reports, suggestions, questions, and (most of all) contributions to fix problems and add features. I personally prefer using the <code>GitHub</code> issues system over trying to reach out to me in other ways (personal e-mail, Twitter, etc.). Pull Requests for contributions are encouraged.</p>
<p>Here are some simple ways in which you can contribute (in the increasing order of commitment):</p>
<ul>
<li><p>Read and correct any inconsistencies in the <a href="https://indrajeetpatil.github.io/groupedstats/">documentation</a></p></li>
<li><p>Raise issues about bugs or wanted features</p></li>
<li><p>Review code</p></li>
<li><p>Add new functionality (in the form of new plotting functions or helpers for preparing subtitles)</p></li>
</ul>
<p>Please note that this project is released with a <a href="https://github.com/IndrajeetPatil/groupedstats/blob/master/CODE_OF_CONDUCT.md">Contributor Code of Conduct</a>. By participating in this project you agree to abide by its terms.</p>
<div id="suggestions" class="section level2">
<h2 class="hasAnchor">
<a href="#suggestions" class="anchor"></a>Suggestions</h2>
<p>If you find any bugs or have any suggestions/remarks, please file an issue on <code>GitHub</code>: <a href="https://github.com/IndrajeetPatil/groupedstats/issues" class="uri">https://github.com/IndrajeetPatil/groupedstats/issues</a></p>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=groupedstats">https://​cloud.r-project.org/​package=groupedstats</a>
</li>
<li>Browse source code at <br><a href="https://github.com/IndrajeetPatil/groupedstats">https://​github.com/​IndrajeetPatil/​groupedstats</a>
</li>
<li>Report a bug at <br><a href="https://github.com/IndrajeetPatil/groupedstats/issues/">
    https://​github.com/​IndrajeetPatil/​groupedstats/​issues/​</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> | file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>
<div class="community">
<h2>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>
<div class="citation">
<h2>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html">Citing groupedstats</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://sites.google.com/site/indrajeetspatilmorality/">Indrajeet Patil</a> <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-1995-6531" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by <a href="https://sites.google.com/site/indrajeetspatilmorality/">Indrajeet Patil</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.9000.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'e4d54f2f161c3166ffc68005afe31d9f',
    indexName: 'groupedstats',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
